<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>War Saga: Mobile</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --bg-dark: #0f0f0f;
            --bg-card: #1a1a1a;
            --accent-red: #e63946;
            --text-main: #f1faee;
            --gray-text: #a8a8a8;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'Segoe UI', sans-serif;
            margin: 0; padding: 0;
            display: flex; flex-direction: column;
            height: 100vh; overflow: hidden;
        }

        /* HEADER */
        .header {
            background: #000;
            padding: 10px 15px;
            border-bottom: 1px solid var(--accent-red);
        }
        .res-row { display: flex; justify-content: space-around; margin-bottom: 10px; font-size: 1.1em; font-weight: bold; }
        .exp-bar { width: 100%; height: 6px; background: #222; border-radius: 3px; overflow: hidden; }
        #exp-fill { height: 100%; background: var(--accent-red); width: 0%; transition: 0.4s; box-shadow: 0 0 10px var(--accent-red); }

        /* CONTENT */
        .main-content { flex: 1; overflow-y: auto; padding: 15px; padding-bottom: 90px; }
        .screen { display: none; flex-direction: column; gap: 12px; }
        .screen.active { display: flex; }

        .title { font-size: 1.3em; color: var(--accent-red); margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }

        /* CARDS */
        .card {
            background: var(--bg-card);
            border-radius: 10px;
            padding: 15px;
            display: flex; align-items: center; gap: 15px;
            border: 1px solid #2a2a2a;
            transition: 0.2s;
        }
        .card:active { border-color: var(--accent-red); transform: scale(0.98); }
        .card-icon { font-size: 2em; }
        .card-info { flex: 1; }
        .card-info h3 { margin: 0; font-size: 1em; }
        .card-info p { margin: 4px 0 0 0; font-size: 0.75em; color: var(--gray-text); }

        /* BOTTOM NAV */
        .nav {
            position: fixed; bottom: 0; width: 100%;
            background: #000; border-top: 1px solid #222;
            display: flex; padding: 10px 0;
            padding-bottom: env(safe-area-inset-bottom);
        }
        .nav-item { flex: 1; text-align: center; color: #555; font-size: 0.65em; text-transform: uppercase; }
        .nav-item.active { color: var(--accent-red); }
        .nav-item span { display: block; font-size: 1.6em; margin-bottom: 3px; }

        /* SUB-SCREENS (–õ–æ–∫–∞—Ü–∏–∏ –≤–Ω—É—Ç—Ä–∏ –∫–∞—Ä—Ç—ã) */
        .sub-screen { display: none; }
        .sub-screen.active { display: block; }
        .back-btn { color: var(--accent-red); margin-bottom: 10px; cursor: pointer; font-size: 0.9em; }

        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="header">
        <div class="res-row">
            <div>ü™ô <span id="gold">50</span></div>
            <div>üíé <span id="emeralds">0</span></div>
        </div>
        <div class="exp-bar"><div id="exp-fill"></div></div>
        <div style="text-align:center; font-size:0.7em; color:var(--accent-red); margin-top:4px;">LVL <span id="lvl">1</span></div>
    </div>

    <div class="main-content">
        
        <div id="screen-map" class="screen active">
            <h2 class="title">–ö–∞—Ä—Ç–∞ –ú–∏—Ä–∞</h2>
            <div class="card" onclick="game.openLocation('tavern')">
                <div class="card-icon">üç∫</div>
                <div class="card-info"><h3>–¢–∞–≤–µ—Ä–Ω–∞ "–•–º–µ–ª—å–Ω–æ–π —Ä—ã—Ü–∞—Ä—å"</h3><p>–°–ª—É—Ö–∏, –∫–≤–µ—Å—Ç—ã –∏ –æ—Ç–¥—ã—Ö</p></div>
            </div>
            <div class="card" onclick="game.openLocation('camp')">
                <div class="card-icon">‚õ∫</div>
                <div class="card-info"><h3>–í–æ–µ–Ω–Ω—ã–π –ª–∞–≥–µ—Ä—å</h3><p>–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –∏ –Ω–∞–µ–º–Ω–∏–∫–∏</p></div>
            </div>
            <div class="card" onclick="game.openLocation('stable')">
                <div class="card-icon">üêé</div>
                <div class="card-info"><h3>–ö–æ–Ω—é—à–Ω—è</h3><p>–õ–æ—à–∞–¥–∏ –¥–ª—è –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–π</p></div>
            </div>
            <div class="card" onclick="game.openLocation('blacksmith')">
                <div class="card-icon">‚öîÔ∏è</div>
                <div class="card-info"><h3>–û—Ä—É–∂–µ–π–Ω–∏–∫</h3><p>–ú–µ—á–∏, —Ç–æ–ø–æ—Ä—ã, –∫–æ–ø—å—è</p></div>
            </div>
            <div class="card" onclick="game.openLocation('armorer')">
                <div class="card-icon">üõ°Ô∏è</div>
                <div class="card-info"><h3>–ë—Ä–æ–Ω–Ω–∏–∫</h3><p>–®–ª–µ–º—ã –∏ –ª–∞—Ç—ã</p></div>
            </div>
        </div>

        <div id="screen-work" class="screen">
            <h2 class="title">–ó–∞—Ä–∞–±–æ—Ç–æ–∫</h2>
            <div class="card" onclick="game.doWork('port')">
                <div class="card-icon">üé£</div>
                <div class="card-info"><h3>–ü–æ—Ä—Ç</h3><p>–î–æ—Ö–æ–¥: +<span id="p-gold">2</span> ü™ô</p></div>
            </div>
            <div class="card" onclick="game.doWork('mine')">
                <div class="card-icon">‚õèÔ∏è</div>
                <div class="card-info"><h3>–†—É–¥–Ω–∏–∫</h3><p>–î–æ—Ö–æ–¥: +<span id="m-gold">1</span> ü™ô</p></div>
            </div>
        </div>

        <div id="screen-shop" class="screen">
            <h2 class="title">–ì–æ—Ä–æ–¥—Å–∫–∞—è –ª–∞–≤–∫–∞</h2>
            <p style="color:var(--gray-text)">–ó–¥–µ—Å—å –ø—Ä–æ–¥–∞—é—Ç—Å—è —Ä–∞—Å—Ö–æ–¥–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã.</p>
        </div>

        <div id="screen-bank" class="screen">
            <h2 class="title">–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π –ë–∞–Ω–∫</h2>
            <div class="card">
                <div class="card-icon">üè¶</div>
                <div class="card-info"><h3>–°–µ–π—Ñ</h3><p>–í–∞—à–µ –∑–æ–ª–æ—Ç–æ –ø–æ–¥ –∑–∞—â–∏—Ç–æ–π.</p></div>
            </div>
        </div>

        <div id="screen-profile" class="screen">
            <h2 class="title">–í–∞—à –ì–µ—Ä–æ–π</h2>
            <div class="card">
                <div class="card-icon">üéñÔ∏è</div>
                <div class="card-info"><h3 id="user-name">–í–æ–∏–Ω</h3><p>–£—Ä–æ–≤–µ–Ω—å: <span id="lvl-p">1</span></p></div>
            </div>
        </div>

        <div id="screen-location" class="screen">
            <div class="back-btn" onclick="game.setTab('map')">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –∫–∞—Ä—Ç—É</div>
            <h2 id="loc-title" class="title">–õ–æ–∫–∞—Ü–∏—è</h2>
            <div id="loc-content"></div>
        </div>

    </div>

    <nav class="nav">
        <div class="nav-item active" onclick="game.setTab('map', this)"><span>üó∫Ô∏è</span>–ö–∞—Ä—Ç–∞</div>
        <div class="nav-item" onclick="game.setTab('work', this)"><span>‚öíÔ∏è</span>–†–∞–±–æ—Ç–∞</div>
        <div class="nav-item" onclick="game.setTab('shop', this)"><span>üí∞</span>–õ–∞–≤–∫–∞</div>
        <div class="nav-item" onclick="game.setTab('bank', this)"><span>üè¶</span>–ë–∞–Ω–∫</div>
        <div class="nav-item" onclick="game.setTab('profile', this)"><span>üë§</span>–ì–µ—Ä–æ–π</div>
    </nav>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const game = {
            gold: 50, emeralds: 0, lvl: 1, xp: 0, nextLvlXp: 100,
            inventory: [],

            setTab(name, el) {
                document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
                document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                document.getElementById('screen-' + name).classList.add('active');
                if(el) el.classList.add('active');
                tg.HapticFeedback.impactOccurred('light');
            },

            openLocation(id) {
                const titles = {
                    tavern: "–¢–∞–≤–µ—Ä–Ω–∞", camp: "–í–æ–µ–Ω–Ω—ã–π –ª–∞–≥–µ—Ä—å", 
                    stable: "–ö–æ–Ω—é—à–Ω—è", blacksmith: "–û—Ä—É–∂–µ–π–Ω–∏–∫", armorer: "–ë—Ä–æ–Ω–Ω–∏–∫"
                };
                document.getElementById('loc-title').innerText = titles[id];
                document.getElementById('loc-content').innerHTML = `<p style="color:var(--gray-text)">–í—ã –ø–æ—Å–µ—Ç–∏–ª–∏ ${titles[id]}. –ü–æ–∫–∞ –∑–¥–µ—Å—å –≤–µ–¥—É—Ç—Å—è —Å—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã...</p>`;
                this.setTab('location');
            },

            doWork(type) {
                if (type === 'port') this.gold += 2;
                else this.gold += 1;
                this.xp += 10;
                if(this.xp >= this.nextLvlXp) {
                    this.lvl++;
                    this.xp = 0;
                    this.nextLvlXp = Math.floor(this.nextLvlXp * 1.5);
                    tg.showAlert("–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å!");
                }
                tg.HapticFeedback.impactOccurred('medium');
                this.updateUI();
            },

            updateUI() {
                document.getElementById('gold').innerText = this.gold;
                document.getElementById('emeralds').innerText = this.emeralds;
                document.getElementById('lvl').innerText = this.lvl;
                document.getElementById('lvl-p').innerText = this.lvl;
                document.getElementById('exp-fill').style.width = (this.xp / this.nextLvlXp * 100) + '%';
            }
        };

        if (tg.initDataUnsafe?.user) {
            document.getElementById('user-name').innerText = tg.initDataUnsafe.user.first_name;
        }
        game.updateUI();
    </script>
</body>
</html>
