# –°—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤–∞—è RPG –¥–ª—è Telegram Mini App

–í–æ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∏–≥—Ä–∞-–∫–ª–∏–∫–µ—Ä —Å —Ç–µ–º–Ω–æ-—Å–µ—Ä—ã–º –¥–∏–∑–∞–π–Ω–æ–º –∏ –∫—Ä–∞—Å–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏:

```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°—Ä–µ–¥–Ω–µ–≤–µ–∫–æ–≤–æ–µ –ö–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–æ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --bg-primary: #1a1a1a;
            --bg-secondary: #2a2a2a;
            --bg-tertiary: #3a3a3a;
            --accent-red: #dc143c;
            --accent-red-dark: #a00a28;
            --accent-red-light: #ff1744;
            --text-primary: #e0e0e0;
            --text-secondary: #b0b0b0;
            --border-color: #4a4a4a;
            --gold: #ffd700;
            --silver: #c0c0c0;
            --success: #28a745;
            --warning: #ffc107;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--bg-primary) 0%, #0d0d0d 100%);
            color: var(--text-primary);
            overflow-x: hidden;
            min-height: 100vh;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding-bottom: 80px;
        }

        /* Header */
        .header {
            background: linear-gradient(180deg, var(--bg-secondary) 0%, var(--bg-primary) 100%);
            padding: 15px;
            border-bottom: 2px solid var(--accent-red);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(220, 20, 60, 0.3);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .player-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 3px solid var(--accent-red);
            background: linear-gradient(135deg, var(--accent-red) 0%, var(--accent-red-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 0 15px rgba(220, 20, 60, 0.5);
        }

        .player-stats {
            display: flex;
            flex-direction: column;
            gap: 3px;
        }

        .player-name {
            font-size: 16px;
            font-weight: bold;
            color: var(--accent-red-light);
        }

        .player-level {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .resources {
            display: flex;
            flex-direction: column;
            gap: 5px;
            align-items: flex-end;
        }

        .resource-item {
            display: flex;
            align-items: center;
            gap: 5px;
            background: var(--bg-tertiary);
            padding: 5px 10px;
            border-radius: 15px;
            border: 1px solid var(--border-color);
        }

        .resource-icon {
            font-size: 14px;
        }

        .resource-value {
            font-weight: bold;
            color: var(--gold);
            font-size: 14px;
        }

        /* Progress Bar */
        .progress-container {
            background: var(--bg-secondary);
            padding: 10px 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-bottom: 5px;
            color: var(--text-secondary);
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: var(--bg-tertiary);
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid var(--border-color);
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-red-dark) 0%, var(--accent-red) 50%, var(--accent-red-light) 100%);
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(220, 20, 60, 0.5);
        }

        .progress-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 11px;
            font-weight: bold;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.8);
        }

        /* Navigation */
        .navigation {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--bg-secondary);
            border-top: 2px solid var(--accent-red);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
            box-shadow: 0 -4px 20px rgba(220, 20, 60, 0.3);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            padding: 5px 15px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 10px;
            position: relative;
        }

        .nav-item:hover {
            background: var(--bg-tertiary);
        }

        .nav-item.active {
            background: var(--accent-red);
            box-shadow: 0 0 15px rgba(220, 20, 60, 0.5);
        }

        .nav-icon {
            font-size: 24px;
        }

        .nav-label {
            font-size: 10px;
            color: var(--text-secondary);
        }

        .nav-item.active .nav-label {
            color: var(--text-primary);
            font-weight: bold;
        }

        .notification-badge {
            position: absolute;
            top: 0;
            right: 5px;
            background: var(--accent-red-light);
            color: white;
            border-radius: 50%;
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(255, 23, 68, 0.8);
        }

        /* Content Sections */
        .content {
            padding: 15px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 15px;
            color: var(--accent-red-light);
            text-shadow: 0 0 10px rgba(220, 20, 60, 0.5);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Cards */
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            transition: all 0.3s;
        }

        .card:hover {
            border-color: var(--accent-red);
            box-shadow: 0 4px 20px rgba(220, 20, 60, 0.3);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .card-title {
            font-size: 18px;
            font-weight: bold;
            color: var(--accent-red);
        }

        .card-subtitle {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .card-content {
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-red) 0%, var(--accent-red-dark) 100%);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--accent-red-light) 0%, var(--accent-red) 100%);
            box-shadow: 0 6px 20px rgba(220, 20, 60, 0.5);
            transform: translateY(-2px);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-primary:disabled {
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            cursor: not-allowed;
            box-shadow: none;
        }

        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
            border-color: var(--accent-red);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--bg-primary);
        }

        .btn-small {
            padding: 8px 16px;
            font-size: 12px;
        }

        .btn-full {
            width: 100%;
        }

        /* Work Section */
        .work-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .work-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .work-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(220, 20, 60, 0.2), transparent);
            transition: left 0.5s;
        }

        .work-card:hover::before {
            left: 100%;
        }

        .work-card:hover {
            border-color: var(--accent-red);
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(220, 20, 60, 0.4);
        }

        .work-card.active {
            border-color: var(--accent-red-light);
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(220, 20, 60, 0.1) 100%);
        }

        .work-icon {
            font-size: 48px;
            margin-bottom: 10px;
            filter: drop-shadow(0 0 5px rgba(220, 20, 60, 0.3));
        }

        .work-name {
            font-size: 16px;
            font-weight: bold;
            color: var(--accent-red);
            margin-bottom: 5px;
        }

        .work-reward {
            font-size: 14px;
            color: var(--gold);
            margin-bottom: 5px;
        }

        .work-energy {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .work-level-req {
            font-size: 11px;
            color: var(--warning);
            margin-bottom: 10px;
        }

        .work-progress {
            width: 100%;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 10px;
        }

        .work-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-red) 0%, var(--accent-red-light) 100%);
            transition: width 0.1s linear;
        }

        /* Inventory */
        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .inventory-slot {
            aspect-ratio: 1;
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            padding: 10px;
        }

        .inventory-slot:hover {
            border-color: var(--accent-red);
            transform: scale(1.05);
        }

        .inventory-slot.empty {
            opacity: 0.3;
            cursor: default;
        }

        .inventory-slot.empty:hover {
            border-color: var(--border-color);
            transform: scale(1);
        }

        .item-icon {
            font-size: 36px;
            margin-bottom: 5px;
        }

        .item-name {
            font-size: 10px;
            text-align: center;
            color: var(--text-secondary);
        }

        .item-count {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: var(--accent-red);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(220, 20, 60, 0.5);
        }

        .item-rarity {
            position: absolute;
            top: 5px;
            left: 5px;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            box-shadow: 0 0 8px currentColor;
        }

        .rarity-common { color: #9e9e9e; }
        .rarity-uncommon { color: #4caf50; }
        .rarity-rare { color: #2196f3; }
        .rarity-epic { color: #9c27b0; }
        .rarity-legendary { color: #ff9800; }

        /* Market */
        .market-filters {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }

        .filter-btn:hover {
            border-color: var(--accent-red);
            color: var(--text-primary);
        }

        .filter-btn.active {
            background: var(--accent-red);
            border-color: var(--accent-red);
            color: white;
        }

        .market-item {
            display: flex;
            align-items: center;
            gap: 15px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            transition: all 0.3s;
        }

        .market-item:hover {
            border-color: var(--accent-red);
            box-shadow: 0 4px 15px rgba(220, 20, 60, 0.3);
        }

        .market-item-icon {
            font-size: 48px;
            min-width: 60px;
            text-align: center;
        }

        .market-item-info {
            flex: 1;
        }

        .market-item-name {
            font-size: 16px;
            font-weight: bold;
            color: var(--accent-red);
            margin-bottom: 5px;
        }

        .market-item-description {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .market-item-stats {
            display: flex;
            gap: 15px;
            font-size: 11px;
            color: var(--text-secondary);
        }

        .market-item-price {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
        }

        .price-tag {
            font-size: 20px;
            font-weight: bold;
            color: var(--gold);
        }

        /* Bank */
        .bank-section {
            margin-bottom: 20px;
        }

        .bank-balance {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(220, 20, 60, 0.1) 100%);
            border: 2px solid var(--accent-red);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .bank-balance-label {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .bank-balance-amount {
            font-size: 36px;
            font-weight: bold;
            color: var(--gold);
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
        }

        .bank-interest {
            font-size: 12px;
            color: var(--success);
            margin-top: 10px;
        }

        .bank-actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 20px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-label {
            display: block;
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .input-field {
            width: 100%;
            padding: 12px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
            transition: all 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-red);
            box-shadow: 0 0 10px rgba(220, 20, 60, 0.3);
        }

        /* Quests */
        .quest-card {
            background: var(--bg-secondary);
            border-left: 4px solid var(--accent-red);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            transition: all 0.3s;
        }

        .quest-card:hover {
            box-shadow: 0 4px 20px rgba(220, 20, 60, 0.3);
            transform: translateX(5px);
        }

        .quest-card.completed {
            border-left-color: var(--success);
            opacity: 0.7;
        }

        .quest-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 10px;
        }

        .quest-title {
            font-size: 16px;
            font-weight: bold;
            color: var(--accent-red);
            margin-bottom: 5px;
        }

        .quest-type {
            font-size: 11px;
            color: var(--text-secondary);
            background: var(--bg-tertiary);
            padding: 3px 8px;
            border-radius: 10px;
        }

        .quest-description {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .quest-progress {
            margin-bottom: 10px;
        }

        .quest-progress-text {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 5px;
        }

        .quest-rewards {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .quest-reward {
            background: var(--bg-tertiary);
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .quest-timer {
            font-size: 12px;
            color: var(--warning);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Profile */
        .profile-header {
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(220, 20, 60, 0.1) 100%);
            border: 2px solid var(--accent-red);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: 4px solid var(--accent-red);
            background: linear-gradient(135deg, var(--accent-red) 0%, var(--accent-red-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 48px;
            margin: 0 auto 15px;
            box-shadow: 0 0 30px rgba(220, 20, 60, 0.5);
        }

        .profile-name {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent-red-light);
            margin-bottom: 5px;
        }

        .profile-title {
            font-size: 14px;
            color: var(--text-secondary);
            margin-bottom: 15px;
        }

        .profile-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-box {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent-red);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .achievements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .achievement-badge {
            aspect-ratio: 1;
            background: var(--bg-tertiary);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 10px;
            transition: all 0.3s;
        }

        .achievement-badge.unlocked {
            border-color: var(--gold);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
        }

        .achievement-badge.locked {
            opacity: 0.3;
            filter: grayscale(100%);
        }

        .achievement-icon {
            font-size: 32px;
            margin-bottom: 5px;
        }

        .achievement-name {
            font-size: 9px;
            text-align: center;
            color: var(--text-secondary);
        }

        /* Skills */
        .skills-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .skill-item {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
        }

        .skill-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .skill-name {
            font-size: 16px;
            font-weight: bold;
            color: var(--accent-red);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .skill-level {
            background: var(--accent-red);
            color: white;
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .skill-description {
            font-size: 12px;
            color: var(--text-secondary);
            margin-bottom: 10px;
        }

        .skill-benefits {
            font-size: 11px;
            color: var(--success);
            margin-bottom: 10px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
            animation: fadeIn 0.3s;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: var(--bg-secondary);
            border: 2px solid var(--accent-red);
            border-radius: 15px;
            padding: 25px;
            max-width: 400px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            box-shadow: 0 10px 40px rgba(220, 20, 60, 0.5);
            animation: slideUp 0.3s;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            color: var(--accent-red-light);
        }

        .modal-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            font-size: 24px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .modal-close:hover {
            color: var(--accent-red);
            transform: rotate(90deg);
        }

        .modal-body {
            color: var(--text-secondary);
        }

        .modal-footer {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--bg-secondary);
            border: 2px solid var(--accent-red);
            border-radius: 10px;
            padding: 15px 20px;
            box-shadow: 0 4px 20px rgba(220, 20, 60, 0.5);
            z-index: 2000;
            animation: slideInRight 0.3s;
            max-width: 300px;
        }

        @keyframes slideInRight {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.success {
            border-color: var(--success);
        }

        .notification.warning {
            border-color: var(--warning);
        }

        .notification-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification-icon {
            font-size: 24px;
        }

        .notification-text {
            flex: 1;
            font-size: 14px;
        }

        /* Tabs */
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }

        .tab {
            padding: 10px 20px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
            font-size: 14px;
        }

        .tab:hover {
            color: var(--text-primary);
        }

        .tab.active {
            color: var(--accent-red);
            border-bottom-color: var(--accent-red);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        /* Animations */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(220, 20, 60, 0.5); }
            50% { box-shadow: 0 0 20px rgba(220, 20, 60, 0.8); }
        }

        .glow {
            animation: glow 2s infinite;
        }

        /* Loading */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid var(--bg-tertiary);
            border-top-color: var(--accent-red);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Tooltip */
        .tooltip {
            position: relative;
            display: inline-block;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            background-color: var(--bg-primary);
            color: var(--text-primary);
            text-align: center;
            border-radius: 6px;
            padding: 8px 12px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            transform: translateX(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 12px;
            white-space: nowrap;
            border: 1px solid var(--accent-red);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.5);
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }

        /* Energy Bar */
        .energy-container {
            background: var(--bg-secondary);
            padding: 10px 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .energy-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
        }

        .energy-label {
            font-size: 12px;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .energy-value {
            font-size: 14px;
            font-weight: bold;
            color: var(--accent-red-light);
        }

        /* Shop Categories */
        .shop-categories {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }

        .category-card {
            background: var(--bg-secondary);
            border: 2px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .category-card:hover {
            border-color: var(--accent-red);
            transform: translateY(-3px);
        }

        .category-card.active {
            border-color: var(--accent-red);
            background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(220, 20, 60, 0.1) 100%);
        }

        .category-icon {
            font-size: 32px;
            margin-bottom: 8px;
        }

        .category-name {
            font-size: 12px;
            color: var(--text-secondary);
        }

        /* Leaderboard */
        .leaderboard-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .leaderboard-item {
            display: flex;
            align-items: center;
            gap: 15px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            transition: all 0.3s;
        }

        .leaderboard-item:hover {
            border-color: var(--accent-red);
        }

        .leaderboard-rank {
            font-size: 24px;
            font-weight: bold;
            color: var(--accent-red);
            min-width: 40px;
            text-align: center;
        }

        .leaderboard-rank.top1 { color: var(--gold); }
        .leaderboard-rank.top2 { color: var(--silver); }
        .leaderboard-rank.top3 { color: #cd7f32; }

        .leaderboard-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            border: 2px solid var(--accent-red);
            background: linear-gradient(135deg, var(--accent-red) 0%, var(--accent-red-dark) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
        }

        .leaderboard-info {
            flex: 1;
        }

        .leaderboard-name {
            font-size: 16px;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 3px;
        }

        .leaderboard-level {
            font-size: 12px;
            color: var(--text-secondary);
        }

        .leaderboard-score {
            font-size: 18px;
            font-weight: bold;
            color: var(--gold);
        }

        /* Settings */
        .settings-section {
            margin-bottom: 25px;
        }

        .settings-title {
            font-size: 16px;
            font-weight: bold;
            color: var(--accent-red);
            margin-bottom: 15px;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .setting-label {
            font-size: 14px;
            color: var(--text-primary);
        }

        .setting-description {
            font-size: 11px;
            color: var(--text-secondary);
            margin-top: 3px;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 26px;
            background: var(--bg-tertiary);
            border-radius: 13px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle-switch.active {
            background: var(--accent-red);
        }

        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s;
        }

        .toggle-switch.active .toggle-slider {
            left: 27px;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .header-content {
                flex-direction: column;
                gap: 10px;
            }

            .resources {
                width: 100%;
                flex-direction: row;
                justify-content: space-between;
            }

            .work-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .profile-stats {
                grid-template-columns: 1fr;
            }

            .bank-actions {
                grid-template-columns: 1fr;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-primary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-red);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-red-light);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <div class="player-info">
                    <div class="avatar">‚öîÔ∏è</div>
                    <div class="player-stats">
                        <div class="player-name" id="playerName">–†—ã—Ü–∞—Ä—å</div>
                        <div class="player-level">–£—Ä–æ–≤–µ–Ω—å <span id="playerLevel">1</span></div>
                    </div>
                </div>
                <div class="resources">
                    <div class="resource-item">
                        <span class="resource-icon">üí∞</span>
                        <span class="resource-value" id="goldAmount">0</span>
                    </div>
                    <div class="resource-item">
                        <span class="resource-icon">üíé</span>
                        <span class="resource-value" id="gemsAmount">0</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-label">
                <span>–û–ø—ã—Ç –¥–æ —Å–ª–µ–¥—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è</span>
                <span id="expText">0/100</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="expBar" style="width: 0%"></div>
                <div class="progress-text" id="expPercent">0%</div>
            </div>
        </div>

        <!-- Energy Bar -->
        <div class="energy-container">
            <div class="energy-info">
                <div class="energy-label">
                    <span>‚ö°</span>
                    <span>–≠–Ω–µ—Ä–≥–∏—è</span>
                </div>
                <div class="energy-value">
                    <span id="currentEnergy">100</span>/<span id="maxEnergy">100</span>
                </div>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="energyBar" style="width: 100%"></div>
            </div>
        </div>

        <!-- Content -->
        <div class="content">
            <!-- Work Section -->
            <div class="section active" id="workSection">
                <div class="section-title">
                    <span>‚öíÔ∏è</span>
                    <span>–†–∞–±–æ—Ç—ã</span>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <div class="card-title">–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–±–æ—Ç—É</div>
                    </div>
                    <div class="card-subtitle">–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –∑–æ–ª–æ—Ç–æ, –≤—ã–ø–æ–ª–Ω—è—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã</div>
                </div>

                <div class="work-grid" id="workGrid">
                    <!-- Work cards will be generated here -->
                </div>
            </div>

            <!-- Inventory Section -->
            <div class="section" id="inventorySection">
                <div class="section-title">
                    <span>üéí</span>
                    <span>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</span>
                </div>

                <div class="tabs">
                    <button class="tab active" onclick="switchInventoryTab('all')">–í—Å–µ</button>
                    <button class="tab" onclick="switchInventoryTab('weapons')">–û—Ä—É–∂–∏–µ</button>
                    <button class="tab" onclick="switchInventoryTab('armor')">–ë—Ä–æ–Ω—è</button>
                    <button class="tab" onclick="switchInventoryTab('consumables')">–†–∞—Å—Ö–æ–¥–Ω–∏–∫–∏</button>
                </div>

                <div class="card">
                    <div class="card-header">
                        <div class="card-title">–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</div>
                        <div class="card-subtitle"><span id="inventoryCount">0</span>/50</div>
                    </div>
                </div>

                <div class="inventory-grid" id="inventoryGrid">
                    <!-- Inventory slots will be generated here -->
                </div>
            </div>

            <!-- Market Section -->
            <div class="section" id="marketSection">
                <div class="section-title">
                    <span>üè™</span>
                    <span>–†—ã–Ω–æ–∫</span>
                </div>

                <div class="shop-categories">
                    <div class="category-card active" onclick="filterMarket('all')">
                        <div class="category-icon">üì¶</div>
                        <div class="category-name">–í—Å–µ</div>
                    </div>
                    <div class="category-card" onclick="filterMarket('weapons')">
                        <div class="category-icon">‚öîÔ∏è</div>
                        <div class="category-name">–û—Ä—É–∂–∏–µ</div>
                    </div>
                    <div class="category-card" onclick="filterMarket('armor')">
                        <div class="category-icon">üõ°Ô∏è</div>
                        <div class="category-name">–ë—Ä–æ–Ω—è</div>
                    </div>
                    <div class="category-card" onclick="filterMarket('tools')">
                        <div class="category-icon">üî®</div>
                        <div class="category-name">–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã</div>
                    </div>
                    <div class="category-card" onclick="filterMarket('consumables')">
                        <div class="category-icon">üß™</div>
                        <div class="category-name">–ó–µ–ª—å—è</div>
                    </div>
                </div>

                <div id="marketItems">
                    <!-- Market items will be generated here -->
                </div>
            </div>

            <!-- Bank Section -->
            <div class="section" id="bankSection">
                <div class="section-title">
                    <span>üè¶</span>
                    <span>–ë–∞–Ω–∫</span>
                </div>

                <div class="bank-balance">
                    <div class="bank-balance-label">–ë–∞–ª–∞–Ω—Å –≤ –±–∞–Ω–∫–µ</div>
                    <div class="bank-balance-amount">
                        <span id="bankBalance">0</span> üí∞
                    </div>
                    <div class="bank-interest">
                        +<span id="dailyInterest">0</span> –∑–æ–ª–æ—Ç–∞ –≤ –¥–µ–Ω—å (5% –≥–æ–¥–æ–≤—ã—Ö)
                    </div>
                </div>

                <div class="tabs">
                    <button class="tab active" onclick="switchBankTab('deposit')">–í–Ω–µ—Å—Ç–∏</button>
                    <button class="tab" onclick="switchBankTab('withdraw')">–°–Ω—è—Ç—å</button>
                    <button class="tab" onclick="switchBankTab('loan')">–ö—Ä–µ–¥–∏—Ç</button>
                </div>

                <div class="tab-content active" id="depositTab">
                    <div class="card">
                        <div class="card-title">–í–Ω–µ—Å—Ç–∏ –∑–æ–ª–æ—Ç–æ</div>
                        <div class="card-subtitle">–•—Ä–∞–Ω–∏—Ç–µ –∑–æ–ª–æ—Ç–æ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –ø—Ä–æ—Ü–µ–Ω—Ç—ã</div>
                        <div class="input-group">
                            <label class="input-label">–°—É–º–º–∞</label>
                            <input type="number" class="input-field" id="depositAmount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É">
                        </div>
                        <button class="btn btn-primary btn-full" onclick="depositGold()">–í–Ω–µ—Å—Ç–∏</button>
                    </div>
                </div>

                <div class="tab-content" id="withdrawTab">
                    <div class="card">
                        <div class="card-title">–°–Ω—è—Ç—å –∑–æ–ª–æ—Ç–æ</div>
                        <div class="card-subtitle">–°–Ω–∏–º–∏—Ç–µ –∑–æ–ª–æ—Ç–æ —Å–æ —Å–≤–æ–µ–≥–æ —Å—á–µ—Ç–∞</div>
                        <div class="input-group">
                            <label class="input-label">–°—É–º–º–∞</label>
                            <input type="number" class="input-field" id="withdrawAmount" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É">
                        </div>
                        <button class="btn btn-primary btn-full" onclick="withdrawGold()">–°–Ω—è—Ç—å</button>
                    </div>
                </div>

                <div class="tab-content" id="loanTab">
                    <div class="card">
                        <div class="card-title">–í–∑—è—Ç—å –∫—Ä–µ–¥–∏—Ç</div>
                        <div class="card-subtitle">–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞: 10% –≤ –¥–µ–Ω—å</div>
                        <div class="card-content">
                            <div style="margin-bottom: 15px;">
                                <strong>–¢–µ–∫—É—â–∏–π –∫—Ä–µ–¥–∏—Ç:</strong> <span id="currentLoan">0</span> üí∞
                            </div>
                            <div class="input-group">
                                <label class="input-label">–°—É–º–º–∞ –∫—Ä–µ–¥–∏—Ç–∞</label>
                                <input type="number" class="input-field" id="loanAmount" placeholder="–ú–∞–∫—Å–∏–º—É–º: 1000">
                            </div>
                            <button class="btn btn-primary btn-full" onclick="takeLoan()">–í–∑—è—Ç—å –∫—Ä–µ–¥–∏—Ç</button>
                            <button class="btn btn-secondary btn-full" style="margin-top: 10px;" onclick="repayLoan()">–ü–æ–≥–∞—Å–∏—Ç—å –∫—Ä–µ–¥–∏—Ç</button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">–ò—Å—Ç–æ—Ä–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π</div>
                    <div id="transactionHistory">
                        <div style="text-align: center; color: var(--text-secondary); padding: 20px;">
                            –ù–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
                        </div>
                    </div>
                </div>
            </div>

            <!-- Quests Section -->
            <div class="section" id="questsSection">
                <div class="section-title">
                    <span>üìú</span>
                    <span>–ö–≤–µ—Å—Ç—ã</span>
                </div>

                <div class="tabs">
                    <button class="tab active" onclick="switchQuestTab('daily')">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ</button>
                    <button class="tab" onclick="switchQuestTab('story')">–°—é–∂–µ—Ç–Ω—ã–µ</button>
                    <button class="tab" onclick="switchQuestTab('completed')">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</button>
                </div>

                <div class="tab-content active" id="dailyQuests">
                    <div class="card">
                        <div class="card-header">
                            <div class="card-title">–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∫–≤–µ—Å—Ç—ã</div>
                            <div class="quest-timer">
                                <span>‚è∞</span>
                                <span id="questResetTimer">23:59:59</span>
                            </div>
                        </div>
                        <div class="card-subtitle">–û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ –ø–æ–ª–Ω–æ—á—å</div>
                    </div>
                    <div id="dailyQuestsList">
                        <!-- Daily quests will be generated here -->
                    </div>
                </div>

                <div class="tab-content" id="storyQuests">
                    <div id="storyQuestsList">
                        <!-- Story quests will be generated here -->
                    </div>
                </div>

                <div class="tab-content" id="completedQuests">
                    <div id="completedQuestsList">
                        <div style="text-align: center; color: var(--text-secondary); padding: 40px;">
                            –í—ã –µ—â–µ –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª–∏ –Ω–∏ –æ–¥–Ω–æ–≥–æ –∫–≤–µ—Å—Ç–∞
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Section -->
            <div class="section" id="profileSection">
                <div class="section-title">
                    <span>üë§</span>
                    <span>–ü—Ä–æ—Ñ–∏–ª—å</span>
                </div>

                <div class="profile-header">
                    <div class="profile-avatar">‚öîÔ∏è</div>
                    <div class="profile-name" id="profileName">–†—ã—Ü–∞—Ä—å</div>
                    <div class="profile-title" id="profileTitle">–ù–∞—á–∏–Ω–∞—é—â–∏–π –∏—Å–∫–∞—Ç–µ–ª—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π</div>
                </div>

                <div class="profile-stats">
                    <div class="stat-box">
                        <div class="stat-value" id="totalGoldEarned">0</div>
                        <div class="stat-label">–ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ –∑–æ–ª–æ—Ç–∞</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="totalWorksDone">0</div>
                        <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ —Ä–∞–±–æ—Ç</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="totalQuestsCompleted">0</div>
                        <div class="stat-label">–ö–≤–µ—Å—Ç–æ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–æ</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value" id="daysPlayed">1</div>
                        <div class="stat-label">–î–Ω–µ–π –≤ –∏–≥—Ä–µ</div>
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">–ù–∞–≤—ã–∫–∏</div>
                    <div class="skills-list" id="skillsList">
                        <!-- Skills will be generated here -->
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</div>
                    <div class="achievements-grid" id="achievementsGrid">
                        <!-- Achievements will be generated here -->
                    </div>
                </div>

                <div class="card">
                    <div class="card-title">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</div>
                    <div class="settings-section">
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">–ó–≤—É–∫–æ–≤—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã</div>
                                <div class="setting-description">–í–∫–ª—é—á–∏—Ç—å –∑–≤—É–∫–∏ –≤ –∏–≥—Ä–µ</div>
                            </div>
                            <div class="toggle-switch active" onclick="toggleSetting(this, 'sound')">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                                <div class="setting-description">–ü–æ–ª—É—á–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ —Å–æ–±—ã—Ç–∏—è—Ö</div>
                            </div>
                            <div class="toggle-switch active" onclick="toggleSetting(this, 'notifications')">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                        <div class="setting-item">
                            <div>
                                <div class="setting-label">–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</div>
                                <div class="setting-description">–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</div>
                            </div>
                            <div class="toggle-switch active" onclick="toggleSetting(this, 'autosave')">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>
                    <button class="btn btn-primary btn-full" onclick="saveGame()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–≥—Ä—É</button>
                    <button class="btn btn-secondary btn-full" style="margin-top: 10px;" onclick="resetGame()">–°–±—Ä–æ—Å–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å</button>
                </div>
            </div>
        </div>

        <!-- Navigation -->
        <div class="navigation">
            <div class="nav-item active" onclick="switchSection('work')">
                <div class="nav-icon">‚öíÔ∏è</div>
                <div class="nav-label">–†–∞–±–æ—Ç–∞</div>
            </div>
            <div class="nav-item" onclick="switchSection('inventory')">
                <div class="nav-icon">üéí</div>
                <div class="nav-label">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</div>
            </div>
            <div class="nav-item" onclick="switchSection('market')">
                <div class="nav-icon">üè™</div>
                <div class="nav-label">–†—ã–Ω–æ–∫</div>
            </div>
            <div class="nav-item" onclick="switchSection('bank')">
                <div class="nav-icon">üè¶</div>
                <div class="nav-label">–ë–∞–Ω–∫</div>
            </div>
            <div class="nav-item" onclick="switchSection('quests')">
                <div class="nav-icon">üìú</div>
                <div class="nav-label">–ö–≤–µ—Å—Ç—ã</div>
                <div class="notification-badge" id="questBadge" style="display: none;">3</div>
            </div>
            <div class="nav-item" onclick="switchSection('profile')">
                <div class="nav-icon">üë§</div>
                <div class="nav-label">–ü—Ä–æ—Ñ–∏–ª—å</div>
            </div>
        </div>
    </div>

    <!-- Item Detail Modal -->
    <div class="modal" id="itemModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="itemModalTitle">–ü—Ä–µ–¥–º–µ—Ç</div>
                <button class="modal-close" onclick="closeModal('itemModal')">√ó</button>
            </div>
            <div class="modal-body" id="itemModalBody">
                <!-- Item details will be shown here -->
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('itemModal')">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button class="btn btn-primary" id="itemModalAction">–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {
            player: {
                name: "–†—ã—Ü–∞—Ä—å",
                level: 1,
                exp: 0,
                expToNext: 100,
                gold: 100,
                gems: 0,
                energy: 100,
                maxEnergy: 100,
                title: "–ù–∞—á–∏–Ω–∞—é—â–∏–π –∏—Å–∫–∞—Ç–µ–ª—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π"
            },
            stats: {
                totalGoldEarned: 0,
                totalWorksDone: 0,
                totalQuestsCompleted: 0,
                daysPlayed: 1
            },
            inventory: [],
            bank: {
                balance: 0,
                loan: 0,
                transactions: []
            },
            skills: {
                mining: { level: 1, exp: 0 },
                woodcutting: { level: 1, exp: 0 },
                farming: { level: 1, exp: 0 },
                fishing: { level: 1, exp: 0 },
                crafting: { level: 1, exp: 0 },
                combat: { level: 1, exp: 0 }
            },
            achievements: [],
            quests: {
                daily: [],
                story: [],
                completed: []
            },
            settings: {
                sound: true,
                notifications: true,
                autosave: true
            },
            lastLogin: Date.now()
        };

        // Work Types
        const workTypes = [
            {
                id: 'mining',
                name: '–î–æ–±—ã—á–∞ —Ä—É–¥—ã',
                icon: '‚õèÔ∏è',
                baseReward: 15,
                energyCost: 10,
                duration: 3000,
                levelRequired: 1,
                expReward: 10,
                skill: 'mining'
            },
            {
                id: 'woodcutting',
                name: '–†—É–±–∫–∞ –ª–µ—Å–∞',
                icon: 'ü™ì',
                baseReward: 12,
                energyCost: 8,
                duration: 2500,
                levelRequired: 1,
                expReward: 8,
                skill: 'woodcutting'
            },
            {
                id: 'farming',
                name: '–§–µ—Ä–º–µ—Ä—Å—Ç–≤–æ',
                icon: 'üåæ',
                baseReward: 10,
                energyCost: 6,
                duration: 2000,
                levelRequired: 1,
                expReward: 6,
                skill: 'farming'
            },
            {
                id: 'fishing',
                name: '–†—ã–±–∞–ª–∫–∞',
                icon: 'üé£',
                baseReward: 8,
                energyCost: 5,
                duration: 1500,
                levelRequired: 1,
                expReward: 5,
                skill: 'fishing'
            },
            {
                id: 'blacksmith',
                name: '–ö—É–∑–Ω–µ—á–Ω–æ–µ –¥–µ–ª–æ',
                icon: '‚öíÔ∏è',
                baseReward: 25,
                energyCost: 15,
                duration: 4000,
                levelRequired: 3,
                expReward: 15,
                skill: 'crafting'
            },
            {
                id: 'hunting',
                name: '–û—Ö–æ—Ç–∞',
                icon: 'üèπ',
                baseReward: 20,
                energyCost: 12,
                duration: 3500,
                levelRequired: 2,
                expReward: 12,
                skill: 'combat'
            },
            {
                id: 'alchemy',
                name: '–ê–ª—Ö–∏–º–∏—è',
                icon: 'üß™',
                baseReward: 30,
                energyCost: 18,
                duration: 4500,
                levelRequired: 5,
                expReward: 20,
                skill: 'crafting'
            },
            {
                id: 'trading',
                name: '–¢–æ—Ä–≥–æ–≤–ª—è',
                icon: 'üíº',
                baseReward: 35,
                energyCost: 20,
                duration: 5000,
                levelRequired: 7,
                expReward: 25,
                skill: 'crafting'
            }
        ];

        // Market Items
        const marketItems = [
            {
                id: 'sword_basic',
                name: '–ñ–µ–ª–µ–∑–Ω—ã–π –º–µ—á',
                icon: '‚öîÔ∏è',
                description: '–ü—Ä–æ—Å—Ç–æ–π –∂–µ–ª–µ–∑–Ω—ã–π –º–µ—á',
                price: 100,
                category: 'weapons',
                rarity: 'common',
                stats: { attack: 5 }
            },
            {
                id: 'sword_steel',
                name: '–°—Ç–∞–ª—å–Ω–æ–π –º–µ—á',
                icon: 'üó°Ô∏è',
                description: '–ü—Ä–æ—á–Ω—ã–π —Å—Ç–∞–ª—å–Ω–æ–π –º–µ—á',
                price: 250,
                category: 'weapons',
                rarity: 'uncommon',
                stats: { attack: 10 }
            },
            {
                id: 'armor_leather',
                name: '–ö–æ–∂–∞–Ω–∞—è –±—Ä–æ–Ω—è',
                icon: 'ü¶∫',
                description: '–õ–µ–≥–∫–∞—è –∫–æ–∂–∞–Ω–∞—è –±—Ä–æ–Ω—è',
                price: 150,
                category: 'armor',
                rarity: 'common',
                stats: { defense: 5 }
            },
            {
                id: 'armor_chain',
                name: '–ö–æ–ª—å—á—É–≥–∞',
                icon: 'üõ°Ô∏è',
                description: '–ü—Ä–æ—á–Ω–∞—è –∫–æ–ª—å—á—É–∂–Ω–∞—è –±—Ä–æ–Ω—è',
                price: 300,
                category: 'armor',
                rarity: 'uncommon',
                stats: { defense: 10 }
            },
            {
                id: 'pickaxe_iron',
                name: '–ñ–µ–ª–µ–∑–Ω–∞—è –∫–∏—Ä–∫–∞',
                icon: '‚õèÔ∏è',
                description: '–£–ª—É—á—à–∞–µ—Ç –¥–æ–±—ã—á—É —Ä—É–¥—ã',
                price: 200,
                category: 'tools',
                rarity: 'common',
                stats: { miningBonus: 20 }
            },
            {
                id: 'axe_iron',
                name: '–ñ–µ–ª–µ–∑–Ω—ã–π —Ç–æ–ø–æ—Ä',
                icon: 'ü™ì',
                description: '–£–ª—É—á—à–∞–µ—Ç —Ä—É–±–∫—É –ª–µ—Å–∞',
                price: 180,
                category: 'tools',
                rarity: 'common',
                stats: { woodcuttingBonus: 20 }
            },
            {
                id: 'potion_health',
                name: '–ó–µ–ª—å–µ –∑–¥–æ—Ä–æ–≤—å—è',
                icon: 'üß™',
                description: '–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç 50 —ç–Ω–µ—Ä–≥–∏–∏',
                price: 50,
                category: 'consumables',
                rarity: 'common',
                consumable: true,
                effect: { energy: 50 }
            },
            {
                id: 'potion_exp',
                name: '–ó–µ–ª—å–µ –æ–ø—ã—Ç–∞',
                icon: '‚ú®',
                description: '–î–∞–µ—Ç 100 –æ–ø—ã—Ç–∞',
                price: 100,
                category: 'consumables',
                rarity: 'uncommon',
                consumable: true,
                effect: { exp: 100 }
            },
            {
                id: 'sword_legendary',
                name: '–≠–∫—Å–∫–∞–ª–∏–±—É—Ä',
                icon: '‚öîÔ∏è',
                description: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –º–µ—á –∫–æ—Ä–æ–ª—è',
                price: 5000,
                category: 'weapons',
                rarity: 'legendary',
                stats: { attack: 50 }
            },
            {
                id: 'armor_legendary',
                name: '–î–æ—Å–ø–µ—Ö–∏ –¥—Ä–∞–∫–æ–Ω–∞',
                icon: 'üõ°Ô∏è',
                description: '–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–µ –¥–æ—Å–ø–µ—Ö–∏ –∏–∑ —á–µ—à—É–∏ –¥—Ä–∞–∫–æ–Ω–∞',
                price: 5000,
                category: 'armor',
                rarity: 'legendary',
                stats: { defense: 50 }
            }
        ];

        // Daily Quests
        const dailyQuestTemplates = [
            {
                id: 'work_5_times',
                name: '–¢—Ä—É–¥–æ–≤–æ–π –¥–µ–Ω—å',
                description: '–í—ã–ø–æ–ª–Ω–∏—Ç–µ –ª—é–±—É—é —Ä–∞–±–æ—Ç—É 5 —Ä–∞–∑',
                type: 'daily',
                requirement: { type: 'work', count: 5 },
                rewards: { gold: 100, exp: 50 }
            },
            {
                id: 'earn_gold',
                name: '–ó–æ–ª–æ—Ç–æ–∏—Å–∫–∞—Ç–µ–ª—å',
                description: '–ó–∞—Ä–∞–±–æ—Ç–∞–π—Ç–µ 200 –∑–æ–ª–æ—Ç–∞',
                type: 'daily',
                requirement: { type: 'earnGold', count: 200 },
                rewards: { gold: 150, exp: 75 }
            },
            {
                id: 'spend_energy',
                name: '–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π',
                description: '–ü–æ—Ç—Ä–∞—Ç—å—Ç–µ 50 —ç–Ω–µ—Ä–≥–∏–∏',
                type: 'daily',
                requirement: { type: 'spendEnergy', count: 50 },
                rewards: { gold: 80, exp: 40 }
            }
        ];

        // Story Quests
        const storyQuests = [
            {
                id: 'first_steps',
                name: '–ü–µ—Ä–≤—ã–µ —à–∞–≥–∏',
                description: '–í—ã–ø–æ–ª–Ω–∏—Ç–µ —Å–≤–æ—é –ø–µ—Ä–≤—É—é —Ä–∞–±–æ—Ç—É',
                type: 'story',
                requirement: { type: 'work', count: 1 },
                rewards: { gold: 50, exp: 25 },
                completed: false
            },
            {
                id: 'merchant',
                name: '–ù–∞—á–∏–Ω–∞—é—â–∏–π —Ç–æ—Ä–≥–æ–≤–µ—Ü',
                description: '–ö—É–ø–∏—Ç–µ —Å–≤–æ–π –ø–µ—Ä–≤—ã–π –ø—Ä–µ–¥–º–µ—Ç –Ω–∞ —Ä—ã–Ω–∫–µ',
                type: 'story',
                requirement: { type: 'buyItem', count: 1 },
                rewards: { gold: 100, exp: 50 },
                completed: false
            },
            {
                id: 'banker',
                name: '–§–∏–Ω–∞–Ω—Å–∏—Å—Ç',
                description: '–ü–æ–ª–æ–∂–∏—Ç–µ 500 –∑–æ–ª–æ—Ç–∞ –≤ –±–∞–Ω–∫',
                type: 'story',
                requirement: { type: 'deposit', count: 500 },
                rewards: { gold: 200, exp: 100 },
                completed: false
            },
            {
                id: 'level_5',
                name: '–û–ø—ã—Ç–Ω—ã–π –∏—Å–∫–∞—Ç–µ–ª—å',
                description: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 5 —É—Ä–æ–≤–Ω—è',
                type: 'story',
                requirement: { type: 'level', count: 5 },
                rewards: { gold: 500, exp: 250, gems: 10 },
                completed: false
            }
        ];

        // Achievements
        const achievements = [
            { id: 'first_work', name: '–ü–µ—Ä–≤–∞—è —Ä–∞–±–æ—Ç–∞', icon: '‚öíÔ∏è', description: '–í—ã–ø–æ–ª–Ω–∏—Ç–µ –ø–µ—Ä–≤—É—é —Ä–∞–±–æ—Ç—É', unlocked: false },
            { id: 'rich', name: '–ë–æ–≥–∞—á', icon: 'üí∞', description: '–ù–∞–∫–æ–ø–∏—Ç–µ 1000 –∑–æ–ª–æ—Ç–∞', unlocked: false },
            { id: 'level_10', name: '–í–µ—Ç–µ—Ä–∞–Ω', icon: '‚≠ê', description: '–î–æ—Å—Ç–∏–≥–Ω–∏—Ç–µ 10 —É—Ä–æ–≤–Ω—è', unlocked: false },
            { id: 'collector', name: '–ö–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä', icon: 'üéí', description: '–°–æ–±–µ—Ä–∏—Ç–µ 20 –ø—Ä–µ–¥–º–µ—Ç–æ–≤', unlocked: false },
            { id: 'quest_master', name: '–ú–∞—Å—Ç–µ—Ä –∫–≤–µ—Å—Ç–æ–≤', icon: 'üìú', description: '–ó–∞–≤–µ—Ä—à–∏—Ç–µ 50 –∫–≤–µ—Å—Ç–æ–≤', unlocked: false },
            { id: 'banker', name: '–ë–∞–Ω–∫–∏—Ä', icon: 'üè¶', description: '–ü–æ–ª–æ–∂–∏—Ç–µ 5000 –∑–æ–ª–æ—Ç–∞ –≤ –±–∞–Ω–∫', unlocked: false },
            { id: 'merchant', name: '–¢–æ—Ä–≥–æ–≤–µ—Ü', icon: 'üè™', description: '–ö—É–ø–∏—Ç–µ 30 –ø—Ä–µ–¥–º–µ—Ç–æ–≤', unlocked: false },
            { id: 'worker', name: '–¢—Ä—É–¥—è–≥–∞', icon: 'üí™', description: '–í—ã–ø–æ–ª–Ω–∏—Ç–µ 100 —Ä–∞–±–æ—Ç', unlocked: false }
        ];

        // Current work
        let currentWork = null;
        let workProgress = 0;
        let workInterval = null;

        // Initialize game
        function initGame() {
            loadGame();
            updateUI();
            generateWorkCards();
            generateInventory();
            generateMarketItems();
            generateSkills();
            generateAchievements();
            generateDailyQuests();
            generateStoryQuests();
            startEnergyRegeneration();
            startQuestTimer();
            
            // Telegram WebApp
            if (window.Telegram && window.Telegram.WebApp) {
                const tg = window.Telegram.WebApp;
                tg.ready();
                tg.expand();
                
                if (tg.initDataUnsafe && tg.initDataUnsafe.user) {
                    gameState.player.name = tg.initDataUnsafe.user.first_name || "–†—ã—Ü–∞—Ä—å";
                    document.getElementById('playerName').textContent = gameState.player.name;
                    document.getElementById('profileName').textContent = gameState.player.name;
                }
            }
        }

        // Update UI
        function updateUI() {
            // Player info
            document.getElementById('playerLevel').textContent = gameState.player.level;
            document.getElementById('goldAmount').textContent = gameState.player.gold;
            document.getElementById('gemsAmount').textContent = gameState.player.gems;
            
            // Experience
            const expPercent = (gameState.player.exp / gameState.player.expToNext) * 100;
            document.getElementById('expBar').style.width = expPercent + '%';
            document.getElementById('expText').textContent = `${gameState.player.exp}/${gameState.player.expToNext}`;
            document.getElementById('expPercent').textContent = Math.floor(expPercent) + '%';
            
            // Energy
            const energyPercent = (gameState.player.energy / gameState.player.maxEnergy) * 100;
            document.getElementById('energyBar').style.width = energyPercent + '%';
            document.getElementById('currentEnergy').textContent = Math.floor(gameState.player.energy);
            document.getElementById('maxEnergy').textContent = gameState.player.maxEnergy;
            
            // Bank
            document.getElementById('bankBalance').textContent = gameState.bank.balance;
            document.getElementById('dailyInterest').textContent = Math.floor(gameState.bank.balance * 0.05 / 365);
            document.getElementById('currentLoan').textContent = gameState.bank.loan;
            
            // Stats
            document.getElementById('totalGoldEarned').textContent = gameState.stats.totalGoldEarned;
            document.getElementById('totalWorksDone').textContent = gameState.stats.totalWorksDone;
            document.getElementById('totalQuestsCompleted').textContent = gameState.stats.totalQuestsCompleted;
            document.getElementById('daysPlayed').textContent = gameState.stats.daysPlayed;
            
            // Profile
            document.getElementById('profileTitle').textContent = gameState.player.title;
            
            // Inventory count
            document.getElementById('inventoryCount').textContent = gameState.inventory.length;
        }

        // Generate work cards
        function generateWorkCards() {
            const workGrid = document.getElementById('workGrid');
            workGrid.innerHTML = '';
            
            workTypes.forEach(work => {
                const isLocked = gameState.player.level < work.levelRequired;
                const skillLevel = gameState.skills[work.skill].level;
                const bonus = (skillLevel - 1) * 0.1;
                const reward = Math.floor(work.baseReward * (1 + bonus));
                
                const card = document.createElement('div');
                card.className = 'work-card';
                if (isLocked) {
                    card.style.opacity = '0.5';
                    card.style.cursor = 'not-allowed';
                }
                
                card.innerHTML = `
                    <div class="work-icon">${work.icon}</div>
                    <div class="work-name">${work.name}</div>
                    <div class="work-reward">+${reward} üí∞</div>
                    <div class="work-energy">-${work.energyCost} ‚ö°</div>
                    ${isLocked ? `<div class="work-level-req">–¢—Ä–µ–±—É–µ—Ç—Å—è ${work.levelRequired} —É—Ä.</div>` : ''}
                    <div class="work-progress" style="display: none;">
                        <div class="work-progress-fill"></div>
                    </div>
                `;
                
                if (!isLocked) {
                    card.onclick = () => startWork(work);
                }
                
                workGrid.appendChild(card);
            });
        }

        // Start work
        function startWork(work) {
            if (currentWork) {
                showNotification('–í—ã —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ!', 'warning');
                return;
            }
            
            if (gameState.player.energy < work.energyCost) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏!', 'warning');
                return;
            }
            
            currentWork = work;
            workProgress = 0;
            
            const cards = document.querySelectorAll('.work-card');
            cards.forEach(card => {
                if (card.querySelector('.work-name').textContent === work.name) {
                    card.classList.add('active');
                    card.querySelector('.work-progress').style.display = 'block';
                }
            });
            
            workInterval = setInterval(() => {
                workProgress += 100;
                const percent = (workProgress / work.duration) * 100;
                
                const activeCard = document.querySelector('.work-card.active');
                if (activeCard) {
                    activeCard.querySelector('.work-progress-fill').style.width = percent + '%';
                }
                
                if (workProgress >= work.duration) {
                    completeWork(work);
                }
            }, 100);
        }

        // Complete work
        function completeWork(work) {
            clearInterval(workInterval);
            workInterval = null;
            currentWork = null;
            
            const skillLevel = gameState.skills[work.skill].level;
            const bonus = (skillLevel - 1) * 0.1;
            const reward = Math.floor(work.baseReward * (1 + bonus));
            
            gameState.player.gold += reward;
            gameState.player.energy -= work.energyCost;
            gameState.player.exp += work.expReward;
            gameState.stats.totalGoldEarned += reward;
            gameState.stats.totalWorksDone++;
            
            // Skill exp
            gameState.skills[work.skill].exp += work.expReward;
            if (gameState.skills[work.skill].exp >= 100) {
                gameState.skills[work.skill].level++;
                gameState.skills[work.skill].exp = 0;
                showNotification(`–ù–∞–≤—ã–∫ ${work.skill} –ø–æ–≤—ã—à–µ–Ω –¥–æ ${gameState.skills[work.skill].level} —É—Ä–æ–≤–Ω—è!`, 'success');
            }
            
            checkLevelUp();
            updateQuestProgress('work', 1);
            updateQuestProgress('earnGold', reward);
            updateQuestProgress('spendEnergy', work.energyCost);
            checkAchievements();
            updateUI();
            
            const cards = document.querySelectorAll('.work-card');
            cards.forEach(card => {
                card.classList.remove('active');
                card.querySelector('.work-progress').style.display = 'none';
                card.querySelector('.work-progress-fill').style.width = '0%';
            });
            
            showNotification(`–ü–æ–ª—É—á–µ–Ω–æ ${reward} üí∞ –∏ ${work.expReward} –æ–ø—ã—Ç–∞!`, 'success');
            
            if (gameState.settings.autosave) {
                saveGame();
            }
        }

        // Check level up
        function checkLevelUp() {
            while (gameState.player.exp >= gameState.player.expToNext) {
                gameState.player.level++;
                gameState.player.exp -= gameState.player.expToNext;
                gameState.player.expToNext = Math.floor(gameState.player.expToNext * 1.5);
                gameState.player.maxEnergy += 10;
                gameState.player.energy = gameState.player.maxEnergy;
                
                showNotification(`–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –í—ã –¥–æ—Å—Ç–∏–≥–ª–∏ ${gameState.player.level} —É—Ä–æ–≤–Ω—è!`, 'success');
                updatePlayerTitle();
                generateWorkCards();
                updateQuestProgress('level', gameState.player.level);
            }
        }

        // Update player title
        function updatePlayerTitle() {
            const level = gameState.player.level;
            if (level >= 50) gameState.player.title = "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –≥–µ—Ä–æ–π";
            else if (level >= 40) gameState.player.title = "–í–µ–ª–∏–∫–∏–π –≤–æ–∏–Ω";
            else if (level >= 30) gameState.player.title = "–ú–∞—Å—Ç–µ—Ä —Å–≤–æ–µ–≥–æ –¥–µ–ª–∞";
            else if (level >= 20) gameState.player.title = "–û–ø—ã—Ç–Ω—ã–π –∏—Å–∫–∞—Ç–µ–ª—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π";
            else if (level >= 10) gameState.player.title = "–£–º–µ–ª—ã–π —Ä–∞–±–æ—Ç–Ω–∏–∫";
            else if (level >= 5) gameState.player.title = "–ü–æ–¥–∞—é—â–∏–π –Ω–∞–¥–µ–∂–¥—ã";
            else gameState.player.title = "–ù–∞—á–∏–Ω–∞—é—â–∏–π –∏—Å–∫–∞—Ç–µ–ª—å –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–π";
        }

        // Energy regeneration
        function startEnergyRegeneration() {
            setInterval(() => {
                if (gameState.player.energy < gameState.player.maxEnergy) {
                    gameState.player.energy = Math.min(gameState.player.energy + 1, gameState.player.maxEnergy);
                    updateUI();
                }
            }, 10000); // 1 energy per 10 seconds
        }

        // Generate inventory
        function generateInventory() {
            const inventoryGrid = document.getElementById('inventoryGrid');
            inventoryGrid.innerHTML = '';
            
            for (let i = 0; i < 50; i++) {
                const slot = document.createElement('div');
                slot.className = 'inventory-slot empty';
                
                if (i < gameState.inventory.length) {
                    const item = gameState.inventory[i];
                    const itemData = marketItems.find(mi => mi.id === item.id);
                    
                    slot.classList.remove('empty');
                    slot.innerHTML = `
                        <div class="item-rarity rarity-${itemData.rarity}"></div>
                        <div class="item-icon">${itemData.icon}</div>
                        <div class="item-name">${itemData.name}</div>
                        ${item.count > 1 ? `<div class="item-count">${item.count}</div>` : ''}
                    `;
                    slot.onclick = () => showItemDetails(itemData, item);
                }
                
                inventoryGrid.appendChild(slot);
            }
        }

        // Show item details
        function showItemDetails(itemData, inventoryItem) {
            const modal = document.getElementById('itemModal');
            const modalTitle = document.getElementById('itemModalTitle');
            const modalBody = document.getElementById('itemModalBody');
            const modalAction = document.getElementById('itemModalAction');
            
            modalTitle.textContent = itemData.name;
            
            let statsHtml = '';
            if (itemData.stats) {
                statsHtml = '<div style="margin-top: 15px;"><strong>–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:</strong><ul style="margin-top: 5px;">';
                for (let [key, value] of Object.entries(itemData.stats)) {
                    statsHtml += `<li>${key}: +${value}</li>`;
                }
                statsHtml += '</ul></div>';
            }
            
            modalBody.innerHTML = `
                <div style="text-align: center; margin-bottom: 15px;">
                    <div style="font-size: 64px;">${itemData.icon}</div>
                    <div style="color: var(--text-secondary); margin-top: 10px;">${itemData.description}</div>
                </div>
                <div><strong>–†–µ–¥–∫–æ—Å—Ç—å:</strong> <span class="rarity-${itemData.rarity}">${itemData.rarity}</span></div>
                <div><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${itemData.category}</div>
                <div><strong>–¶–µ–Ω–∞:</strong> ${itemData.price} üí∞</div>
                ${inventoryItem ? `<div><strong>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</strong> ${inventoryItem.count}</div>` : ''}
                ${statsHtml}
            `;
            
            if (itemData.consumable) {
                modalAction.textContent = '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å';
                modalAction.onclick = () => useItem(itemData, inventoryItem);
                modalAction.style.display = 'block';
            } else {
                modalAction.style.display = 'none';
            }
            
            modal.classList.add('active');
        }

        // Use item
        function useItem(itemData, inventoryItem) {
            if (itemData.effect) {
                if (itemData.effect.energy) {
                    gameState.player.energy = Math.min(
                        gameState.player.energy + itemData.effect.energy,
                        gameState.player.maxEnergy
                    );
                }
                if (itemData.effect.exp) {
                    gameState.player.exp += itemData.effect.exp;
                    checkLevelUp();
                }
            }
            
            inventoryItem.count--;
            if (inventoryItem.count <= 0) {
                const index = gameState.inventory.indexOf(inventoryItem);
                gameState.inventory.splice(index, 1);
            }
            
            updateUI();
            generateInventory();
            closeModal('itemModal');
            showNotification(`–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø—Ä–µ–¥–º–µ—Ç: ${itemData.name}`, 'success');
            saveGame();
        }

        // Generate market items
        function generateMarketItems(filter = 'all') {
            const marketItemsContainer = document.getElementById('marketItems');
            marketItemsContainer.innerHTML = '';
            
            const filteredItems = filter === 'all' 
                ? marketItems 
                : marketItems.filter(item => item.category === filter);
            
            filteredItems.forEach(item => {
                const itemCard = document.createElement('div');
                itemCard.className = 'market-item';
                
                let statsHtml = '';
                if (item.stats) {
                    for (let [key, value] of Object.entries(item.stats)) {
                        statsHtml += `<span>${key}: +${value}</span>`;
                    }
                }
                
                itemCard.innerHTML = `
                    <div class="market-item-icon">${item.icon}</div>
                    <div class="market-item-info">
                        <div class="market-item-name">${item.name}</div>
                        <div class="market-item-description">${item.description}</div>
                        <div class="market-item-stats">
                            <span class="rarity-${item.rarity}">${item.rarity}</span>
                            ${statsHtml}
                        </div>
                    </div>
                    <div class="market-item-price">
                        <div class="price-tag">${item.price} üí∞</div>
                        <button class="btn btn-primary btn-small" onclick="buyItem('${item.id}')">–ö—É–ø–∏—Ç—å</button>
                    </div>
                `;
                
                marketItemsContainer.appendChild(itemCard);
            });
        }

        // Buy item
        function buyItem(itemId) {
            const item = marketItems.find(i => i.id === itemId);
            
            if (gameState.player.gold < item.price) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞!', 'warning');
                return;
            }
            
            if (gameState.inventory.length >= 50) {
                showNotification('–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø–æ–ª–æ–Ω!', 'warning');
                return;
            }
            
            gameState.player.gold -= item.price;
            
            const existingItem = gameState.inventory.find(i => i.id === itemId);
            if (existingItem) {
                existingItem.count++;
            } else {
                gameState.inventory.push({ id: itemId, count: 1 });
            }
            
            updateUI();
            generateInventory();
            updateQuestProgress('buyItem', 1);
            checkAchievements();
            showNotification(`–ö—É–ø–ª–µ–Ω –ø—Ä–µ–¥–º–µ—Ç: ${item.name}`, 'success');
            saveGame();
        }

        // Filter market
        function filterMarket(category) {
            const categories = document.querySelectorAll('.category-card');
            categories.forEach(cat => cat.classList.remove('active'));
            event.target.closest('.category-card').classList.add('active');
            generateMarketItems(category);
        }

        // Bank functions
        function depositGold() {
            const amount = parseInt(document.getElementById('depositAmount').value);
            
            if (!amount || amount <= 0) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É', 'warning');
                return;
            }
            
            if (gameState.player.gold < amount) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞!', 'warning');
                return;
            }
            
            gameState.player.gold -= amount;
            gameState.bank.balance += amount;
            gameState.bank.transactions.push({
                type: 'deposit',
                amount: amount,
                date: new Date().toLocaleString()
            });
            
            updateUI();
            updateQuestProgress('deposit', amount);
            checkAchievements();
            showNotification(`–í–Ω–µ—Å–µ–Ω–æ ${amount} –∑–æ–ª–æ—Ç–∞ –≤ –±–∞–Ω–∫`, 'success');
            document.getElementById('depositAmount').value = '';
            saveGame();
        }

        function withdrawGold() {
            const amount = parseInt(document.getElementById('withdrawAmount').value);
            
            if (!amount || amount <= 0) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Å—É–º–º—É', 'warning');
                return;
            }
            
            if (gameState.bank.balance < amount) {
                showNotification('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –≤ –±–∞–Ω–∫–µ!', 'warning');
                return;
            }
            
            gameState.bank.balance -= amount;
            gameState.player.gold += amount;
            gameState.bank.transactions.push({
                type: 'withdraw',
                amount: amount,
                date: new Date().toLocaleString()
            });
            
            updateUI();
            showNotification(`–°–Ω—è—Ç–æ ${amount} –∑–æ–ª–æ—Ç–∞ –∏–∑ –±–∞–Ω–∫–∞`, 'success');
            document.getElementById('withdrawAmount').value = '';
            saveGame();
        }

        function takeLoan() {
            const amount = parseInt(document.getElementById('loanAmount').value);
            
            if (!amount || amount <= 0 || amount > 1000) {
                showNotification('–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É –æ—Ç 1 –¥–æ 1000', 'warning');
                return;
            }
            
            if (gameState.bank.loan > 0) {
                showNotification('–°–Ω–∞—á–∞–ª–∞ –ø–æ–≥–∞—Å–∏—Ç–µ —Ç–µ–∫—É—â–∏–π –∫—Ä–µ–¥–∏—Ç!', 'warning');
                return;
            }
            
            gameState.bank.loan = amount;
            gameState.player.gold += amount;
            gameState.bank.transactions.push({
                type: 'loan',
                amount: amount,
                date: new Date().toLocaleString()
            });
            
            updateUI();
            showNotification(`–í–∑—è—Ç –∫—Ä–µ–¥–∏—Ç –Ω–∞ ${amount} –∑–æ–ª–æ—Ç–∞`, 'success');
            document.getElementById('loanAmount').value = '';
            saveGame();
        }

        function repayLoan() {
            if (gameState.bank.loan <= 0) {
                showNotification('–£ –≤–∞—Å –Ω–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∫—Ä–µ–¥–∏—Ç–∞', 'warning');
                return;
            }
            
            const totalDebt = Math.floor(gameState.bank.loan * 1.1);
            
            if (gameState.player.gold < totalDebt) {
                showNotification(`–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∑–æ–ª–æ—Ç–∞! –ù—É–∂–Ω–æ ${totalDebt} –∑–æ–ª–æ—Ç–∞`, 'warning');
                return;
            }
            
            gameState.player.gold -= totalDebt;
            gameState.bank.loan = 0;
            gameState.bank.transactions.push({
                type: 'repay',
                amount: totalDebt,
                date: new Date().toLocaleString()
            });
            
            updateUI();
            showNotification('–ö—Ä–µ–¥–∏—Ç –ø–æ–≥–∞—à–µ–Ω!', 'success');
            saveGame();
        }

        // Generate daily quests
        function generateDailyQuests() {
            const container = document.getElementById('dailyQuestsList');
            container.innerHTML = '';
            
            if (gameState.quests.daily.length === 0) {
                dailyQuestTemplates.forEach(template => {
                    gameState.quests.daily.push({
                        ...template,
                        progress: 0,
                        completed: false
                    });
                });
            }
            
            gameState.quests.daily.forEach(quest => {
                const questCard = createQuestCard(quest);
                container.appendChild(questCard);
            });
        }

        // Generate story quests
        function generateStoryQuests() {
            const container = document.getElementById('storyQuestsList');
            container.innerHTML = '';
            
            if (gameState.quests.story.length === 0) {
                gameState.quests.story = [...storyQuests];
            }
            
            gameState.quests.story.forEach(quest => {
                if (!quest.completed) {
                    const questCard = createQuestCard(quest);
                    container.appendChild(questCard);
                }
            });
        }

        // Create quest card
        function createQuestCard(quest) {
            const card = document.createElement('div');
            card.className = 'quest-card';
            if (quest.completed) card.classList.add('completed');
            
            const progress = quest.progress || 0;
            const required = quest.requirement.count;
            const progressPercent = Math.min((progress / required) * 100, 100);
            
            let rewardsHtml = '';
            if (quest.rewards.gold) rewardsHtml += `<div class="quest-reward">üí∞ ${quest.rewards.gold}</div>`;
            if (quest.rewards.exp) rewardsHtml += `<div class="quest-reward">‚≠ê ${quest.rewards.exp} –æ–ø—ã—Ç–∞</div>`;
            if (quest.rewards.gems) rewardsHtml += `<div class="quest-reward">üíé ${quest.rewards.gems}</div>`;
            
            card.innerHTML = `
                <div class="quest-header">
                    <div>
                        <div class="quest-title">${quest.name}</div>
                        <div class="quest-type">${quest.type === 'daily' ? '–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π' : '–°—é–∂–µ—Ç–Ω—ã–π'}</div>
                    </div>
                </div>
                <div class="quest-description">${quest.description}</div>
                <div class="quest-progress">
                    <div class="quest-progress-text">${progress}/${required}</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progressPercent}%"></div>
                    </div>
                </div>
                <div class="quest-rewards">
                    ${rewardsHtml}
                </div>
                ${quest.completed 
                    ? '<button class="btn btn-secondary btn-small btn-full" disabled>–ó–∞–≤–µ—Ä—à–µ–Ω–æ</button>'
                    : progressPercent >= 100 
                        ? `<button class="btn btn-primary btn-small btn-full" onclick="claimQuest('${quest.id}', '${quest.type}')">–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É</button>`
                        : '<button class="btn btn-secondary btn-small btn-full" disabled>–í –ø—Ä–æ—Ü–µ—Å—Å–µ</button>'
                }
            `;
            
            return card;
        }

        // Update quest progress
        function updateQuestProgress(type, amount) {
            let updated = false;
            
            gameState.quests.daily.forEach(quest => {
                if (!quest.completed && quest.requirement.type === type) {
                    quest.progress = (quest.progress || 0) + amount;
                    updated = true;
                }
            });
            
            gameState.quests.story.forEach(quest => {
                if (!quest.completed && quest.requirement.type === type) {
                    if (type === 'level') {
                        quest.progress = amount;
                    } else {
                        quest.progress = (quest.progress || 0) + amount;
                    }
                    updated = true;
                }
            

## –û—à–∏–±–∫–∞ max_tokens –ø–µ—Ä–µ—Å–æ–∑–¥–∞–π—Ç–µ —á–∞—Ç
