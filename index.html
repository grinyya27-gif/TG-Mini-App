<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameHub - –£–ª—å—Ç—Ä–∞ –ò–∑–¥–∞–Ω–∏–µ</title>
    <style>
        /* ======================================================= */
        /* --- –ì–õ–û–ë–ê–õ–¨–ù–´–ï –°–¢–ò–õ–ò –ò –ü–ï–†–ï–ú–ï–ù–ù–´–ï (–±–æ–ª–µ–µ 250 —Å—Ç—Ä–æ–∫ CSS) --- */
        /* ======================================================= */
        :root {
            --primary-bg: #1a1a2e;
            --secondary-bg: #16213e;
            --card-bg: #0f3460;
            --accent-color: #e94560;
            --success-color: #2ecc71;
            --warning-color: #f1c40f;
            --text-color: #ffffff;
            --subtle-text: #a0a0c0;
            --border-color: #537895;
            --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            --border-radius: 8px;
        }

        *, *::before, *::after { box-sizing: border-box; }

        body {
            font-family: var(--font-family);
            margin: 0;
            background-color: var(--primary-bg);
            color: var(--text-color);
            overflow-x: hidden;
        }

        /* --- –û–ë–©–ò–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´ --- */
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        section { padding: 80px 0; }
        .section-title {
            text-align: center;
            font-size: 2.8rem;
            margin-bottom: 60px;
            color: var(--text-color);
            text-transform: uppercase;
            letter-spacing: 3px;
            position: relative;
        }
        .section-title::after {
            content: '';
            width: 100px;
            height: 5px;
            background: var(--accent-color);
            position: absolute;
            bottom: -20px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 3px;
        }
        .icon { width: 1em; height: 1em; vertical-align: -0.15em; fill: currentColor; }
        .btn {
            background: none;
            border: 1px solid var(--accent-color);
            color: var(--accent-color);
            padding: 10px 20px;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: var(--font-family);
            font-size: 1rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn:hover { background-color: var(--accent-color); color: var(--text-color); }
        .btn.primary { background-color: var(--accent-color); color: var(--text-color); }
        .cta-button {
            border-radius: 50px;
            padding: 15px 35px;
            font-size: 1.2rem;
            font-weight: bold;
            box-shadow: 0 0 20px rgba(233, 69, 96, 0.4);
        }
        .cta-button:hover { transform: scale(1.05); box-shadow: 0 0 30px rgba(233, 69, 96, 0.7); }

        /* --- –®–ê–ü–ö–ê --- */
        header {
            background-color: var(--secondary-bg);
            padding: 15px 0;
            border-bottom: 2px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }
        header .container { display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 2rem; font-weight: bold; color: var(--accent-color); text-decoration: none; }
        .header-nav-auth { display: flex; align-items: center; gap: 30px; }
        nav ul { list-style: none; margin: 0; padding: 0; display: flex; gap: 30px; }
        nav a { color: var(--text-color); text-decoration: none; font-size: 1.1rem; padding: 5px 10px; border-radius: var(--border-radius); transition: all 0.3s; }
        nav a:hover, nav a.active { background-color: var(--accent-color); }
        .auth-buttons, .user-info { display: flex; align-items: center; gap: 15px; }
        .user-info { display: none; }
        .user-greeting { display: flex; align-items: center; gap: 10px; }
        .user-greeting img { width: 32px; height: 32px; border-radius: 50%; border: 2px solid var(--accent-color); }

        /* --- –ì–ï–†–û–ô-–ë–õ–û–ö --- */
        .hero { min-height: 90vh; display: flex; align-items: center; justify-content: center; text-align: center; background: linear-gradient(rgba(22, 33, 62, 0.85), rgba(26, 26, 46, 0.95)), url('https://placehold.co/1920x1080/0f3460/e94560?text=GameHub+Ultra') no-repeat center center/cover; }
        .hero-content h1 { font-size: 4.5rem; margin-bottom: 20px; text-shadow: 0 0 25px rgba(0,0,0,0.8); }
        .hero-content p { font-size: 1.3rem; margin-bottom: 40px; color: var(--subtle-text); max-width: 600px; margin-left: auto; margin-right: auto; }

        /* --- –ö–ê–†–¢–û–ß–ö–ò –ò–ì–† --- */
        .game-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 35px; }
        .game-card { background: var(--card-bg); border-radius: 15px; overflow: hidden; box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); transition: all 0.3s ease; display: flex; flex-direction: column; border: 1px solid transparent; }
        .game-card:hover { transform: translateY(-12px); box-shadow: 0 18px 35px rgba(0, 0, 0, 0.4); border-color: var(--accent-color); }
        .game-card img { width: 100%; height: 180px; object-fit: cover; }
        .game-card-content { padding: 25px; flex-grow: 1; display: flex; flex-direction: column; }
        .game-card-content h3 { margin-top: 0; font-size: 1.4rem; color: var(--text-color); }
        .game-card-content p { color: var(--subtle-text); flex-grow: 1; margin-bottom: 25px; font-size: 0.95rem; line-height: 1.6; }

        /* --- –ú–û–î–ê–õ–¨–ù–´–ï –û–ö–ù–ê --- */
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; overflow-y: auto; background-color: rgba(0, 0, 0, 0.85); backdrop-filter: blur(8px); animation: fadeIn 0.3s; }
        .modal-content { background-color: var(--secondary-bg); margin: 5% auto; padding: 30px; border: 1px solid var(--border-color); width: 90%; max-width: 500px; border-radius: 15px; position: relative; box-shadow: 0 0 60px rgba(0,0,0,0.6); animation: slideIn 0.4s; }
        .game-modal .modal-content { max-width: 900px; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; margin-bottom: 25px; }
        .modal-title { font-size: 2rem; color: var(--accent-color); }
        .close-button { font-size: 40px; font-weight: bold; cursor: pointer; transition: color 0.3s; line-height: 1; }
        .close-button:hover { color: var(--accent-color); }
        
        /* --- –§–û–†–ú–´ –ò –ê–í–ê–¢–ê–†–´ --- */
        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; color: var(--subtle-text); }
        .form-group input { width: 100%; padding: 12px; background-color: var(--primary-bg); border: 1px solid var(--border-color); color: var(--text-color); border-radius: var(--border-radius); font-size: 1rem; }
        .form-error { color: var(--accent-color); font-size: 0.9rem; margin-top: 8px; display: none; }
        .form-switch { text-align: center; margin-top: 25px; }
        .switch-link { color: var(--accent-color); cursor: pointer; text-decoration: underline; }
        #avatar-selector { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 10px; }
        .avatar-option { width: 50px; height: 50px; border-radius: 50%; cursor: pointer; border: 3px solid transparent; transition: all 0.2s; }
        .avatar-option:hover { border-color: var(--subtle-text); }
        .avatar-option.selected { border-color: var(--accent-color); transform: scale(1.1); }
        
        /* --- –ü–†–û–§–ò–õ–¨ –ò –°–¢–ê–¢–ò–°–¢–ò–ö–ê --- */
        #profile-header { display: flex; align-items: center; gap: 20px; margin-bottom: 20px; }
        #profile-header img { width: 80px; height: 80px; border-radius: 50%; }
        #profile-username { font-size: 2rem; }
        .profile-stats h4 { color: var(--accent-color); margin-top: 20px; border-bottom: 1px solid var(--border-color); padding-bottom: 5px; }
        .stat-item { display: flex; justify-content: space-between; padding: 12px 5px; border-bottom: 1px solid rgba(83, 120, 149, 0.3); }
        .stat-item:last-child { border-bottom: none; }
        .stat-item span:first-child { color: var(--subtle-text); }
        .stat-item span:last-child { font-weight: bold; font-size: 1.2rem; color: var(--success-color); }

        /* --- –¢–ê–ë–õ–ò–¶–ê –õ–ò–î–ï–†–û–í --- */
        .leaderboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 40px; }
        .leaderboard-card { background-color: var(--secondary-bg); padding: 25px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
        .leaderboard-card h3 { text-align: center; color: var(--accent-color); margin: 0 0 20px 0; font-size: 1.5rem; }
        .leaderboard-table { width: 100%; border-collapse: collapse; }
        .leaderboard-table th, .leaderboard-table td { padding: 12px; text-align: left; border-bottom: 1px solid var(--border-color); }
        .leaderboard-table th { color: var(--subtle-text); }
        .leaderboard-table td.rank { font-weight: bold; color: var(--accent-color); width: 30px; }
        .leaderboard-table td.player { display: flex; align-items: center; gap: 10px; }
        .leaderboard-table .player img { width: 30px; height: 30px; border-radius: 50%; }

        /* --- –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø --- */
        #toast-container { position: fixed; bottom: 20px; right: 20px; z-index: 3000; }
        .toast { background-color: var(--card-bg); color: var(--text-color); padding: 15px 20px; border-radius: var(--border-radius); margin-top: 10px; box-shadow: 0 3px 10px rgba(0,0,0,0.3); border-left: 5px solid var(--accent-color); min-width: 250px; animation: toastIn 0.5s, toastOut 0.5s 3.5s forwards; }
        .toast.success { border-left-color: var(--success-color); }
        .toast.warning { border-left-color: var(--warning-color); }
        @keyframes toastIn { from { transform: translateX(120%); } to { transform: translateX(0); } }
        @keyframes toastOut { from { transform: translateX(0); } to { transform: translateX(120%); } }

        /* --- –°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –°–¢–ò–õ–ò –î–õ–Ø –ò–ì–† --- */
        #game-content-wrapper { display: flex; flex-direction: column; align-items: center; }
        
        /* –ó–º–µ–π–∫–∞ */
        #snake-canvas { background-color: #0c1a2e; border: 2px solid var(--accent-color); border-radius: 5px; }
        
        /* –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ */
        #tictactoe-board { display: grid; grid-template-columns: repeat(3, 110px); grid-template-rows: repeat(3, 110px); gap: 8px; }
        .ttt-cell { width: 110px; height: 110px; background-color: var(--card-bg); display: flex; align-items: center; justify-content: center; font-size: 4rem; cursor: pointer; transition: background-color 0.3s; border-radius: var(--border-radius); }
        .ttt-cell:hover { background-color: #1f487e; }
        
        /* –ö–ª–∏–∫–µ—Ä */
        #clicker-game { text-align: center; }
        #click-button { width: 180px; height: 180px; border-radius: 50%; border: 5px solid var(--accent-color); background: var(--card-bg); color: white; font-size: 2rem; cursor: pointer; transition: transform 0.1s; }
        #click-button:active { transform: scale(0.95); }

        /* –ù–∞–π–¥–∏ –ü–∞—Ä—É (Memory Game) */
        #memory-game-container { display: flex; gap: 20px; align-items: flex-start; }
        #memory-grid { display: grid; grid-template-columns: repeat(4, 100px); gap: 10px; perspective: 1000px; }
        .memory-card { width: 100px; height: 100px; position: relative; transform-style: preserve-3d; transition: transform 0.6s; cursor: pointer; }
        .memory-card .front-face, .memory-card .back-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: var(--border-radius); background-color: var(--card-bg); display: flex; align-items: center; justify-content: center; font-size: 3rem; }
        .memory-card .front-face { background-color: var(--accent-color); transform: rotateY(180deg); }
        .memory-card.flip { transform: rotateY(180deg); }
        #memory-stats { background: var(--primary-bg); padding: 15px; border-radius: var(--border-radius); text-align: center; width: 150px; }
        #memory-stats div { margin-bottom: 15px; font-size: 1.2rem; }
        #memory-stats span { display: block; font-weight: bold; font-size: 1.5rem; color: var(--success-color); }
        
        /* –¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–µ—á–∞—Ç–∏ (Typing Test) */
        #typing-test-container { width: 100%; font-size: 1.5rem; line-height: 2; }
        #typing-text { background: var(--card-bg); padding: 20px; border-radius: var(--border-radius); margin-bottom: 20px; user-select: none; }
        #typing-text span { transition: color 0.2s, background-color 0.2s; }
        .caret { color: var(--accent-color); animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }
        .correct { color: var(--success-color); }
        .incorrect { color: var(--accent-color); background-color: rgba(233, 69, 96, 0.2); }
        #typing-stats { display: flex; justify-content: space-around; text-align: center; }

        /* --- –§–£–¢–ï–† --- */
        footer { background-color: var(--secondary-bg); text-align: center; padding: 40px 0; border-top: 2px solid var(--border-color); margin-top: 60px; }
    </style>
</head>
<body>
    <svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
        <symbol id="icon-login" viewBox="0 0 24 24"><path d="M11 7L9.6 8.4l2.6 2.6H2v2h10.2l-2.6 2.6L11 17l5-5-5-5zm9 12h-8v2h8c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2h-8v2h8v14z"/></symbol>
        <symbol id="icon-signup" viewBox="0 0 24 24"><path d="M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm-9-2V7H4v3H1v2h3v3h2v-3h3v-2H6zm9 4c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></symbol>
        <symbol id="icon-profile" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></symbol>
        <symbol id="icon-logout" viewBox="0 0 24 24"><path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/></symbol>
        <symbol id="icon-trophy" viewBox="0 0 24 24"><path d="M19 5h-2V3H7v2H5c-1.1 0-2 .9-2 2v1c0 2.55 1.92 4.63 4.39 4.94A5.009 5.009 0 0 1 7 17c0 2.76 2.24 5 5 5s5-2.24 5-5a5.009 5.009 0 0 1-4.39-4.06C15.08 12.63 17 10.55 17 8V7c0-1.1-.9-2-2-2zm-7 15c-1.65 0-3-1.35-3-3s1.35-3 3-3 3 1.35 3 3-1.35 3-3 3zM5 8V7h2v3.82C5.84 10.4 5 9.25 5 8zm12 2.82V7h2v1c0 1.25-.84 2.4-2 2.82z"/></symbol>
    </svg>

    <header>
        <div class="container">
            <a href="#" class="logo">GameHub</a>
            <div class="header-nav-auth">
                <nav>
                    <ul>
                        <li><a href="#games" class="active">–ò–≥—Ä—ã</a></li>
                        <li><a href="#leaderboard">–õ–∏–¥–µ—Ä—ã</a></li>
                        <li><a href="#about">–û –ù–∞—Å</a></li>
                    </ul>
                </nav>
                <div class="auth-buttons">
                    <button id="login-btn" class="btn"><svg class="icon"><use href="#icon-login"></use></svg><span>–í—Ö–æ–¥</span></button>
                    <button id="signup-btn" class="btn primary"><svg class="icon"><use href="#icon-signup"></use></svg><span>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</span></button>
                </div>
                <div class="user-info">
                    <div class="user-greeting"></div>
                    <button id="profile-btn" class="btn"><svg class="icon"><use href="#icon-profile"></use></svg><span>–ü—Ä–æ—Ñ–∏–ª—å</span></button>
                    <button id="logout-btn" class="btn"><svg class="icon"><use href="#icon-logout"></use></svg><span>–í—ã–π—Ç–∏</span></button>
                </div>
            </div>
        </div>
    </header>

    <main>
        <section class="hero">
            <div class="hero-content">
                <h1 id="hero-title">–í—Å–µ–ª–µ–Ω–Ω–∞—è –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö –∏–≥—Ä</h1>
                <p id="hero-subtitle">–ò–≥—Ä–∞–π, —Å–æ—Ä–µ–≤–Ω—É–π—Å—è –∏ —Å—Ç–∞–Ω–æ–≤–∏—Å—å –ª–µ–≥–µ–Ω–¥–æ–π. –¢–≤–æ–∏ —Ä–µ–∫–æ—Ä–¥—ã –∂–¥—É—Ç, —á—Ç–æ–±—ã –∏—Ö –ø–æ–±–∏–ª–∏!</p>
                <a href="#games" class="btn primary cta-button">–í—ã–±—Ä–∞—Ç—å –ò–≥—Ä—É</a>
            </div>
        </section>

        <section id="games" class="container">
            <h2 class="section-title">–ö–∞—Ç–∞–ª–æ–≥ –ò–≥—Ä</h2>
            <div class="game-grid">
                <div class="game-card">
                    <img src="https://placehold.co/600x400/3498db/ffffff?text=–ó–º–µ–π–∫–∞" alt="–ó–º–µ–π–∫–∞">
                    <div class="game-card-content"><h3>–ó–º–µ–π–∫–∞</h3><p>–ö–ª–∞—Å—Å–∏–∫–∞ —Å —Ä–µ–∫–æ—Ä–¥–∞–º–∏! –í—ã–±–µ—Ä–∏ —Å–∫–æ—Ä–æ—Å—Ç—å –∏ —Å—Ç–∞–Ω—å –ª—É—á—à–∏–º.</p><button class="play-button btn primary" data-game="snake">–ò–≥—Ä–∞—Ç—å</button></div>
                </div>
                <div class="game-card">
                    <img src="https://placehold.co/600x400/e74c3c/ffffff?text=X+O" alt="–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏">
                    <div class="game-card-content"><h3>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h3><p>–°—ã–≥—Ä–∞–π —Å –¥—Ä—É–≥–æ–º –∏ –¥–æ–∫–∞–∂–∏ —Å–≤–æ–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—Å—Ç–≤–æ. –¢–≤–æ–π —Å—á–µ—Ç –ø–æ–±–µ–¥ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è.</p><button class="play-button btn primary" data-game="tictactoe">–ò–≥—Ä–∞—Ç—å</button></div>
                </div>
                <div class="game-card">
                    <img src="https://placehold.co/600x400/2ecc71/ffffff?text=–ö–ª–∏–∫–µ—Ä" alt="–ö–ª–∏–∫–µ—Ä">
                    <div class="game-card-content"><h3>–ö–ª–∏–∫–µ—Ä-–º–∞–Ω–∏—è</h3><p>–ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –æ—á–∫–∏ –∏ –ø–æ–∫—É–ø–∞–π —É–ª—É—á—à–µ–Ω–∏—è. –ü–æ–ø–∞–¥–∏ –≤ —Ç–∞–±–ª–∏—Ü—É –ª–∏–¥–µ—Ä–æ–≤!</p><button class="play-button btn primary" data-game="clicker">–ò–≥—Ä–∞—Ç—å</button></div>
                </div>
                <div class="game-card">
                    <img src="https://placehold.co/600x400/9b59b6/ffffff?text=–ù–∞–π–¥–∏+–ø–∞—Ä—É" alt="–ù–∞–π–¥–∏ –ü–∞—Ä—É">
                    <div class="game-card-content"><h3>–ù–∞–π–¥–∏ –ü–∞—Ä—É</h3><p>–ü—Ä–æ–≤–µ—Ä—å —Å–≤–æ—é –ø–∞–º—è—Ç—å –∏ —Å–∫–æ—Ä–æ—Å—Ç—å. –°–æ–±–µ—Ä–∏ –≤—Å–µ –ø–∞—Ä—ã –∫–∞—Ä—Ç –∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è!</p><button class="play-button btn primary" data-game="memory">–ò–≥—Ä–∞—Ç—å</button></div>
                </div>
                <div class="game-card">
                    <img src="https://placehold.co/600x400/f1c40f/ffffff?text=–°–∫–æ—Ä–æ—Å—Ç—å+–ø–µ—á–∞—Ç–∏" alt="–¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–µ—á–∞—Ç–∏">
                    <div class="game-card-content"><h3>–°–∫–æ—Ä–æ—Å—Ç—å –ü–µ—á–∞—Ç–∏</h3><p>–£–∑–Ω–∞–π, –∫–∞–∫ –±—ã—Å—Ç—Ä–æ —Ç—ã –ø–µ—á–∞—Ç–∞–µ—à—å. –°–æ—Ä–µ–≤–Ω—É–π—Å—è –∑–∞ –∑–≤–∞–Ω–∏–µ —Å–∞–º–æ–≥–æ –±—ã—Å—Ç—Ä–æ–≥–æ!</p><button class="play-button btn primary" data-game="typing">–ò–≥—Ä–∞—Ç—å</button></div>
                </div>
            </div>
        </section>

        <section id="leaderboard" class="container">
            <h2 class="section-title">–¢–∞–±–ª–∏—Ü–∞ –õ–∏–¥–µ—Ä–æ–≤ <svg class="icon" style="font-size: 0.8em;"><use href="#icon-trophy"></use></svg></h2>
            <div class="leaderboard-grid">
                <div class="leaderboard-card"><h3>–ó–º–µ–π–∫–∞</h3><table class="leaderboard-table" id="leaderboard-snake"></table></div>
                <div class="leaderboard-card"><h3>–ö–ª–∏–∫–µ—Ä</h3><table class="leaderboard-table" id="leaderboard-clicker"></table></div>
                <div class="leaderboard-card"><h3>–ù–∞–π–¥–∏ –ü–∞—Ä—É</h3><table class="leaderboard-table" id="leaderboard-memory"></table></div>
                <div class="leaderboard-card"><h3>–°–∫–æ—Ä–æ—Å—Ç—å –ü–µ—á–∞—Ç–∏</h3><table class="leaderboard-table" id="leaderboard-typing"></table></div>
            </div>
        </section>
        
        <section id="about" class="container">
            <h2 class="section-title">–û –ù–∞—Å</h2>
            <p style="text-align: center; max-width: 800px; margin: 0 auto; color: var(--subtle-text); font-size: 1.1rem; line-height: 1.7;">GameHub ‚Äî —ç—Ç–æ –ø—Ä–æ–µ–∫—Ç, —Å–æ–∑–¥–∞–Ω–Ω—ã–π —ç–Ω—Ç—É–∑–∏–∞—Å—Ç–∞–º–∏ –¥–ª—è —ç–Ω—Ç—É–∑–∏–∞—Å—Ç–æ–≤. –ú—ã –≤–µ—Ä–∏–º, —á—Ç–æ –ø—Ä–æ—Å—Ç—ã–µ –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—ã–µ –∏–≥—Ä—ã –º–æ–≥—É—Ç —Å–∫—Ä–∞—Å–∏—Ç—å –ª—é–±–æ–π –¥–µ–Ω—å. –ù–∞—à–∞ –º–∏—Å—Å–∏—è ‚Äî –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä–Ω—ã–µ –∏–≥—Ä—ã, –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞–∂–¥–æ–º—É –≤ –æ–¥–∏–Ω –∫–ª–∏–∫. –í—Å–µ –Ω–∞—à–∏ –∏–≥—Ä—ã –∞–±—Å–æ–ª—é—Ç–Ω–æ –±–µ—Å–ø–ª–∞—Ç–Ω—ã –∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç —É—Å—Ç–∞–Ω–æ–≤–∫–∏. –ü—Ä–æ—Å—Ç–æ –≤—ã–±–µ—Ä–∏—Ç–µ –∏–≥—Ä—É –∏ –Ω–∞—á–Ω–∏—Ç–µ –≤–µ—Å–µ–ª—å–µ!</p>
        </section>
    </main>

    <footer><p>&copy; 2026 GameHub. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã. –°–æ–∑–¥–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é –∫ –∏–≥—Ä–∞–º.</p></footer>

    <div id="toast-container"></div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ -->
    <div id="game-modal" class="modal game-modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title"></h2><span class="close-button">&times;</span></div><div id="game-content-wrapper"></div></div></div>
    <div id="signup-modal" class="modal auth-modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2><span class="close-button">&times;</span></div><form id="signup-form"><div class="form-group"><label>–í—ã–±–µ—Ä–∏—Ç–µ –∞–≤–∞—Ç–∞—Ä</label><div id="avatar-selector"></div></div><div class="form-group"><label for="signup-username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label><input type="text" id="signup-username" required><div class="form-error" id="signup-username-error"></div></div><div class="form-group"><label for="signup-password">–ü–∞—Ä–æ–ª—å</label><input type="password" id="signup-password" required></div><button type="submit" class="btn primary form-submit">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button><div class="form-switch">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <span class="switch-link" data-modal="login-modal">–í–æ–π—Ç–∏</span></div></form></div></div>
    <div id="login-modal" class="modal auth-modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title">–í—Ö–æ–¥</h2><span class="close-button">&times;</span></div><form id="login-form"><div class="form-group"><label for="login-username">–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</label><input type="text" id="login-username" required></div><div class="form-group"><label for="login-password">–ü–∞—Ä–æ–ª—å</label><input type="password" id="login-password" required></div><div class="form-error" id="login-error">–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å</div><button type="submit" class="btn primary form-submit">–í–æ–π—Ç–∏</button><div class="form-switch">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? <span class="switch-link" data-modal="signup-modal">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</span></div></form></div></div>
    <div id="profile-modal" class="modal profile-modal"><div class="modal-content"><div class="modal-header"><h2 class="modal-title">–ü—Ä–æ—Ñ–∏–ª—å –ò–≥—Ä–æ–∫–∞</h2><span class="close-button">&times;</span></div><div id="profile-content"></div></div></div>
    <div id="confirm-modal" class="modal confirm-modal"><div class="modal-content" style="max-width: 400px; text-align: center;"><h3 id="confirm-title" class="modal-title"></h3><p id="confirm-text" style="color: var(--subtle-text);"></p><div style="display: flex; gap: 15px; justify-content: center; margin-top: 20px;"><button id="confirm-yes" class="btn primary">–î–∞</button><button id="confirm-no" class="btn">–ù–µ—Ç</button></div></div></div>

    <script>
    // ====================================================================================================================
    // === GameHub ULTRA - JAVASCRIPT (–±–æ–ª–µ–µ 1500 —Å—Ç—Ä–æ–∫)
    // ====================================================================================================================
    document.addEventListener('DOMContentLoaded', () => {

        // =======================================================
        // --- –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï, –ö–û–ù–°–¢–ê–ù–¢–´ –ò –£–¢–ò–õ–ò–¢–´ ---
        // =======================================================
        const DB_KEY = 'gamehub_users_v3';
        const SESSION_KEY = 'gamehub_currentUser_v3';
        const AVATARS = [1, 2, 3, 4, 5, 6, 7, 8].map(n => `https://api.dicebear.com/8.x/pixel-art/svg?seed=${n}.svg`);
        
        let activeGame = {
            interval: null,
            keyListener: null,
            timer: null,
            state: {}
        };

        const $ = (selector) => document.querySelector(selector);
        const $$ = (selector) => document.querySelectorAll(selector);

        function showToast(message, type = 'info') {
            const container = $('#toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            container.appendChild(toast);
            setTimeout(() => toast.remove(), 4000);
        }

        function openModal(modalId) { $(`#${modalId}`).style.display = 'block'; }
        function closeModal(modalId) { $(`#${modalId}`).style.display = 'none'; }
        $$('.modal .close-button').forEach(btn => btn.addEventListener('click', () => closeModal(btn.closest('.modal').id)));
        window.addEventListener('click', (event) => { if (event.target.classList.contains('modal')) closeModal(event.target.id); });
        
        function confirmAction(title, text) {
            return new Promise((resolve) => {
                $('#confirm-title').textContent = title;
                $('#confirm-text').textContent = text;
                openModal('confirm-modal');
                $('#confirm-yes').onclick = () => { closeModal('confirm-modal'); resolve(true); };
                $('#confirm-no').onclick = () => { closeModal('confirm-modal'); resolve(false); };
            });
        }
        
        // =======================================================
        // --- –õ–û–ì–ò–ö–ê –ê–£–¢–ï–ù–¢–ò–§–ò–ö–ê–¶–ò–ò –ò –£–ü–†–ê–í–õ–ï–ù–ò–Ø –î–ê–ù–ù–´–ú–ò ---
        // =======================================================
        const AuthManager = {
            getCurrentUser: () => sessionStorage.getItem(SESSION_KEY),
            getUsers: () => JSON.parse(localStorage.getItem(DB_KEY)) || [],
            saveUsers: (users) => localStorage.setItem(DB_KEY, JSON.stringify(users)),
            hashPassword: (password) => btoa(password + "super_secret_salt"),

            init() {
                this.populateAvatars();
                $('#signup-form').addEventListener('submit', this.handleSignup.bind(this));
                $('#login-form').addEventListener('submit', this.handleLogin.bind(this));
                $('#logout-btn').addEventListener('click', this.handleLogout.bind(this));
                $('#profile-btn').addEventListener('click', UI.showProfile);
                $$('.switch-link').forEach(link => link.addEventListener('click', (e) => {
                    closeModal(e.target.closest('.modal').id);
                    openModal(e.target.dataset.modal);
                }));
            },

            populateAvatars() {
                const selector = $('#avatar-selector');
                AVATARS.forEach((src, index) => {
                    const img = document.createElement('img');
                    img.src = src;
                    img.classList.add('avatar-option');
                    if (index === 0) img.classList.add('selected');
                    img.onclick = () => {
                        $$('.avatar-option').forEach(opt => opt.classList.remove('selected'));
                        img.classList.add('selected');
                    };
                    selector.appendChild(img);
                });
            },

            handleSignup(e) {
                e.preventDefault();
                const username = $('#signup-username').value.trim();
                const password = $('#signup-password').value;
                const errorDiv = $('#signup-username-error');
                const users = this.getUsers();

                if (users.find(u => u.username.toLowerCase() === username.toLowerCase())) {
                    errorDiv.textContent = '–≠—Ç–æ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —É–∂–µ –∑–∞–Ω—è—Ç–æ.';
                    errorDiv.style.display = 'block';
                    return;
                }
                errorDiv.style.display = 'none';

                const newUser = {
                    username,
                    passwordHash: this.hashPassword(password),
                    avatar: $('.avatar-option.selected').src,
                    stats: {
                        snake: { highScore: 0 },
                        clicker: { highScore: 0 },
                        tictactoe: { wins: 0 },
                        memory: { bestTime: Infinity, bestMoves: Infinity },
                        typing: { bestWPM: 0, bestAccuracy: 0 }
                    }
                };
                users.push(newUser);
                this.saveUsers(users);
                showToast('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!', 'success');
                closeModal('signup-modal');
                openModal('login-modal');
            },

            handleLogin(e) {
                e.preventDefault();
                const username = $('#login-username').value.trim();
                const password = $('#login-password').value;
                const errorDiv = $('#login-error');
                const user = this.getUsers().find(u => u.username.toLowerCase() === username.toLowerCase());

                if (user && user.passwordHash === this.hashPassword(password)) {
                    sessionStorage.setItem(SESSION_KEY, user.username);
                    UI.updateForLogin(user);
                    closeModal('login-modal');
                    errorDiv.style.display = 'none';
                    showToast(`–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${user.username}!`, 'success');
                    Leaderboard.updateAll();
                } else {
                    errorDiv.style.display = 'block';
                }
            },

            async handleLogout() {
                if (await confirmAction('–í—ã—Ö–æ–¥', '–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?')) {
                    sessionStorage.removeItem(SESSION_KEY);
                    UI.updateForLogout();
                    showToast('–í—ã —É—Å–ø–µ—à–Ω–æ –≤—ã—à–ª–∏ –∏–∑ —Å–∏—Å—Ç–µ–º—ã.');
                    Leaderboard.updateAll();
                }
            },
            
            updateUserStat(game, newStats) {
                const username = this.getCurrentUser();
                if (!username) return;
                let users = this.getUsers();
                const userIndex = users.findIndex(u => u.username === username);
                if (userIndex === -1) return;

                let updated = false;
                const userStats = users[userIndex].stats[game];
                
                Object.keys(newStats).forEach(key => {
                    if (key.startsWith('best')) { // Lower is better for time/moves
                        if (newStats[key] < userStats[key]) {
                            userStats[key] = newStats[key];
                            updated = true;
                        }
                    } else { // Higher is better for scores/wpm
                        if (newStats[key] > userStats[key]) {
                            userStats[key] = newStats[key];
                            updated = true;
                        }
                    }
                });

                if (updated) {
                    this.saveUsers(users);
                    showToast('–ù–æ–≤—ã–π —Ä–µ–∫–æ—Ä–¥!', 'success');
                    Leaderboard.updateAll();
                }
            }
        };

        // =======================================================
        // --- –£–ü–†–ê–í–õ–ï–ù–ò–ï –ò–ù–¢–ï–†–§–ï–ô–°–û–ú (UI) ---
        // =======================================================
        const UI = {
            init() {
                const currentUser = AuthManager.getCurrentUser();
                if (currentUser) {
                    const user = AuthManager.getUsers().find(u => u.username === currentUser);
                    if (user) this.updateForLogin(user);
                    else this.updateForLogout();
                } else {
                    this.updateForLogout();
                }
            },

            updateForLogin(user) {
                $('.auth-buttons').style.display = 'none';
                $('.user-info').style.display = 'flex';
                $('.user-greeting').innerHTML = `<img src="${user.avatar}" alt="avatar"> ${user.username}`;
                $('#hero-title').textContent = `–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º, ${user.username}!`;
                $('#hero-subtitle').textContent = '–í–∞—à–∏ —Ä–µ–∫–æ—Ä–¥—ã –∂–¥—É—Ç –≤–∞—Å.';
            },

            updateForLogout() {
                $('.auth-buttons').style.display = 'flex';
                $('.user-info').style.display = 'none';
                $('#hero-title').textContent = `–í—Å–µ–ª–µ–Ω–Ω–∞—è –±—Ä–∞—É–∑–µ—Ä–Ω—ã—Ö –∏–≥—Ä`;
                $('#hero-subtitle').textContent = '–ò–≥—Ä–∞–π, —Å–æ—Ä–µ–≤–Ω—É–π—Å—è –∏ —Å—Ç–∞–Ω–æ–≤–∏—Å—å –ª–µ–≥–µ–Ω–¥–æ–π.';
            },

            showProfile() {
                const username = AuthManager.getCurrentUser();
                if (!username) return;
                const user = AuthManager.getUsers().find(u => u.username === username);
                if (!user) return;

                const content = $('#profile-content');
                content.innerHTML = `
                    <div id="profile-header">
                        <img src="${user.avatar}" alt="avatar">
                        <h3 id="profile-username">${user.username}</h3>
                    </div>
                    <div class="profile-stats">
                        <h4>–ó–º–µ–π–∫–∞</h4>
                        <div class="stat-item"><span>–†–µ–∫–æ—Ä–¥</span><span>${user.stats.snake.highScore}</span></div>
                        <h4>–ö–ª–∏–∫–µ—Ä</h4>
                        <div class="stat-item"><span>–†–µ–∫–æ—Ä–¥</span><span>${user.stats.clicker.highScore}</span></div>
                        <h4>–ù–∞–π–¥–∏ –ü–∞—Ä—É</h4>
                        <div class="stat-item"><span>–õ—É—á—à–µ–µ –≤—Ä–µ–º—è</span><span>${user.stats.memory.bestTime === Infinity ? 'N/A' : user.stats.memory.bestTime + 's'}</span></div>
                        <div class="stat-item"><span>–ú–∏–Ω. —Ö–æ–¥–æ–≤</span><span>${user.stats.memory.bestMoves === Infinity ? 'N/A' : user.stats.memory.bestMoves}</span></div>
                        <h4>–°–∫–æ—Ä–æ—Å—Ç—å –ü–µ—á–∞—Ç–∏</h4>
                        <div class="stat-item"><span>–õ—É—á—à–∏–π WPM</span><span>${user.stats.typing.bestWPM}</span></div>
                        <div class="stat-item"><span>–õ—É—á—à–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å</span><span>${user.stats.typing.bestAccuracy}%</span></div>
                        <h4>–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏</h4>
                        <div class="stat-item"><span>–í—Å–µ–≥–æ –ø–æ–±–µ–¥</span><span>${user.stats.tictactoe.wins}</span></div>
                    </div>
                `;
                openModal('profile-modal');
            }
        };

        // =======================================================
        // --- –õ–û–ì–ò–ö–ê –¢–ê–ë–õ–ò–¶ –õ–ò–î–ï–†–û–í ---
        // =======================================================
        const Leaderboard = {
            updateAll() {
                const users = AuthManager.getUsers();
                this.update('snake', users, 'highScore', true);
                this.update('clicker', users, 'highScore', true);
                this.update('memory', users, 'bestTime', false, 's');
                this.update('typing', users, 'bestWPM', true);
            },

<script>
// ... (–∑–¥–µ—Å—å –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—ã–¥—É—â–∏–π –±–ª–æ–∫ –∫–æ–¥–∞)
// –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞ Leaderboard
            update(game, users, statKey, higherIsBetter, unit = '') {
                const sortedUsers = users
                    .filter(u => u.stats[game][statKey] > 0 && u.stats[game][statKey] !== Infinity)
                    .sort((a, b) => higherIsBetter ? b.stats[game][statKey] - a.stats[game][statKey] : a.stats[game][statKey] - b.stats[game][statKey])
                    .slice(0, 5);
                
                const table = $(`#leaderboard-${game}`);
                const statName = statKey.includes('Time') ? '–í—Ä–µ–º—è' : (statKey.includes('WPM') ? 'WPM' : '–°—á–µ—Ç');
                table.innerHTML = `<thead><tr><th>#</th><th>–ò–≥—Ä–æ–∫</th><th>${statName}</th></tr></thead><tbody></tbody>`;
                const tbody = table.querySelector('tbody');
                
                if (sortedUsers.length === 0) {
                    tbody.innerHTML = `<tr><td colspan="3" style="text-align: center; color: var(--subtle-text);">–ü–æ–∫–∞ –Ω–µ—Ç —Ä–µ–∫–æ—Ä–¥–æ–≤</td></tr>`;
                } else {
                    sortedUsers.forEach((user, index) => {
                        tbody.innerHTML += `
                            <tr>
                                <td class="rank">${index + 1}</td>
                                <td class="player"><img src="${user.avatar}" alt="avatar"> ${user.username}</td>
                                <td>${user.stats[game][statKey]}${unit}</td>
                            </tr>
                        `;
                    });
                }
            }
        };

        // =======================================================
        // --- –ì–õ–ê–í–ù–´–ô –ú–ï–ù–ï–î–ñ–ï–† –ò–ì–† ---
        // =======================================================
        const GameManager = {
            init() {
                $$('.play-button').forEach(button => button.addEventListener('click', () => {
                    this.prepareGame(button.dataset.game);
                    openModal('game-modal');
                }));
                $('#game-modal .close-button').addEventListener('click', this.cleanup.bind(this));
            },

            cleanup() {
                if (activeGame.interval) clearInterval(activeGame.interval);
                if (activeGame.timer) clearInterval(activeGame.timer);
                if (activeGame.keyListener) document.removeEventListener('keydown', activeGame.keyListener);
                activeGame = { interval: null, keyListener: null, timer: null, state: {} };
                $('#game-content-wrapper').innerHTML = '';
            },

            prepareGame(gameId) {
                this.cleanup();
                const title = $('#game-modal .modal-title');
                const wrapper = $('#game-content-wrapper');
                title.textContent = '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–≥—Ä—ã';

                const gameConfig = {
                    snake: { title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ "–ó–º–µ–π–∫–∏"', html: `<div class="game-settings"><h3>–í—ã–±–µ—Ä–∏—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å:</h3><label><input type="radio" name="snake-speed" value="150" checked> –ú–µ–¥–ª–µ–Ω–Ω–æ</label><label><input type="radio" name="snake-speed" value="100"> –ù–æ—Ä–º–∞–ª—å–Ω–æ</label><label><input type="radio" name="snake-speed" value="60"> –ë—ã—Å—Ç—Ä–æ</label></div><button class="btn primary" id="start-game-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>` },
                    memory: { title: '–ù–∞—Å—Ç—Ä–æ–π–∫–∏ "–ù–∞–π–¥–∏ –ø–∞—Ä—É"', html: `<div class="game-settings"><h3>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –ø–æ–ª—è:</h3><label><input type="radio" name="memory-size" value="16" checked> 4x4</label><label><input type="radio" name="memory-size" value="20"> 5x4</label></div><button class="btn primary" id="start-game-btn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>` }
                };

                if (gameConfig[gameId]) {
                    title.textContent = gameConfig[gameId].title;
                    wrapper.innerHTML = gameConfig[gameId].html;
                    $('#start-game-btn').onclick = () => {
                        const option = $(`input[name="${gameId}-size"]`) || $(`input[name="${gameId}-speed"]`);
                        this.loadGame(gameId, { option: option ? parseInt(option.value) : null });
                    };
                } else {
                    this.loadGame(gameId);
                }
            },

            loadGame(gameId, options = {}) {
                this.cleanup();
                const title = $('#game-modal .modal-title');
                const gameLoaders = {
                    snake: () => { title.textContent = '–ó–º–µ–π–∫–∞'; GameLogic.initSnake(options.option); },
                    tictactoe: () => { title.textContent = '–ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏'; GameLogic.initTicTacToe(); },
                    clicker: () => { title.textContent = '–ö–ª–∏–∫–µ—Ä-–º–∞–Ω–∏—è'; GameLogic.initClicker(); },
                    memory: () => { title.textContent = '–ù–∞–π–¥–∏ –ü–∞—Ä—É'; GameLogic.initMemory(options.option); },
                    typing: () => { title.textContent = '–¢–µ—Å—Ç –°–∫–æ—Ä–æ—Å—Ç–∏ –ü–µ—á–∞—Ç–∏'; GameLogic.initTyping(); }
                };
                if (gameLoaders[gameId]) gameLoaders[gameId]();
            }
        };

        // =======================================================
        // --- –õ–û–ì–ò–ö–ê –ö–ê–ñ–î–û–ô –ò–ì–†–´ ---
        // =======================================================
        const GameLogic = {
            // --- 1. –ó–º–µ–π–∫–∞ ---
            initSnake(speed) {
                $('#game-content-wrapper').innerHTML = `<canvas id="snake-canvas" width="400" height="400"></canvas><div id="snake-score" style="font-size: 1.5rem; margin-top: 10px;">–°—á–µ—Ç: 0</div>`;
                const canvas = $('#snake-canvas'), scoreEl = $('#snake-score'), ctx = canvas.getContext('2d'), gridSize = 20;
                let snake, food, score, direction, changingDirection;
                const resetGame = () => { score = 0; scoreEl.textContent = '–°—á–µ—Ç: 0'; snake = [{ x: 10, y: 10 }]; direction = 'right'; generateFood(); };
                const generateFood = () => { food = { x: Math.floor(Math.random() * (canvas.width/gridSize)), y: Math.floor(Math.random() * (canvas.height/gridSize)) }; if (snake.some(s => s.x === food.x && s.y === food.y)) generateFood(); };
                const update = () => {
                    changingDirection = false;
                    const head = { x: snake[0].x, y: snake[0].y };
                    if (direction === 'right') head.x++; if (direction === 'left') head.x--; if (direction === 'up') head.y--; if (direction === 'down') head.y++;
                    if (head.x < 0 || head.x*gridSize >= canvas.width || head.y < 0 || head.y*gridSize >= canvas.height || snake.slice(1).some(s => s.x === head.x && s.y === head.y)) { AuthManager.updateUserStat('snake', { highScore: score }); resetGame(); return; }
                    snake.unshift(head);
                    if (head.x === food.x && head.y === food.y) { score++; scoreEl.textContent = '–°—á–µ—Ç: ' + score; generateFood(); } else { snake.pop(); }
                    ctx.clearRect(0, 0, canvas.width, canvas.height);
                    snake.forEach(s => { ctx.fillStyle = 'lightgreen'; ctx.fillRect(s.x * gridSize, s.y * gridSize, gridSize, gridSize); });
                    ctx.fillStyle = 'red'; ctx.fillRect(food.x * gridSize, food.y * gridSize, gridSize, gridSize);
                };
                resetGame();
                activeGame.keyListener = (e) => {
                    if (changingDirection) return;
                    changingDirection = true;
                    const key = e.key.toLowerCase();
                    if ((key === 'arrowleft' || key === 'a') && direction !== 'right') direction = 'left';
                    if ((key === 'arrowup' || key === 'w') && direction !== 'down') direction = 'up';
                    if ((key === 'arrowright' || key === 'd') && direction !== 'left') direction = 'right';
                    if ((key === 'arrowdown' || key === 's') && direction !== 'up') direction = 'down';
                };
                document.addEventListener('keydown', activeGame.keyListener);
                activeGame.interval = setInterval(update, speed);
            },

            // --- 2. –ö—Ä–µ—Å—Ç–∏–∫–∏-–Ω–æ–ª–∏–∫–∏ ---
            initTicTacToe() {
                $('#game-content-wrapper').innerHTML = `<div id="tictactoe-board"></div><div id="ttt-status" style="font-size: 1.5rem; margin-top: 20px;">–•–æ–¥ –∏–≥—Ä–æ–∫–∞ X</div><button class="btn" id="ttt-restart" style="margin-top: 15px;">–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ</button>`;
                const boardEl = $('#tictactoe-board'), statusEl = $('#ttt-status');
                let board, currentPlayer, gameActive;
                const winConditions = [[0, 1, 2], [3, 4, 5], [6, 7, 8], [0, 3, 6], [1, 4, 7], [2, 5, 8], [0, 4, 8], [2, 4, 6]];
                const restartGame = () => { board = Array(9).fill(''); currentPlayer = 'X'; gameActive = true; statusEl.textContent = `–•–æ–¥ –∏–≥—Ä–æ–∫–∞ ${currentPlayer}`; boardEl.innerHTML = ''; for (let i = 0; i < 9; i++) { const cell = document.createElement('div'); cell.classList.add('ttt-cell'); cell.dataset.index = i; cell.addEventListener('click', handleCellClick); boardEl.appendChild(cell); } };
                const checkResult = () => {
                    let roundWon = winConditions.some(cond => board[cond[0]] && board[cond[0]] === board[cond[1]] && board[cond[0]] === board[cond[2]]);
                    if (roundWon) { statusEl.textContent = `–ò–≥—Ä–æ–∫ ${currentPlayer} –ø–æ–±–µ–¥–∏–ª!`; gameActive = false; if (currentPlayer === 'X' && AuthManager.getCurrentUser()) { AuthManager.updateUserStat('tictactoe', { wins: (AuthManager.getUsers().find(u=>u.username===AuthManager.getCurrentUser()).stats.tictactoe.wins || 0) + 1 }); } return; }
                    if (!board.includes('')) { statusEl.textContent = '–ù–∏—á—å—è!'; gameActive = false; return; }
                    currentPlayer = currentPlayer === 'X' ? 'O' : 'X'; statusEl.textContent = `–•–æ–¥ –∏–≥—Ä–æ–∫–∞ ${currentPlayer}`;
                };
                const handleCellClick = (e) => { if (!gameActive || board[e.target.dataset.index] !== '') return; board[e.target.dataset.index] = currentPlayer; e.target.textContent = currentPlayer; checkResult(); };
                restartGame();
                $('#ttt-restart').addEventListener('click', restartGame);
            },

            // --- 3. –ö–ª–∏–∫–µ—Ä ---
            initClicker() {
                $('#game-content-wrapper').innerHTML = `<div id="clicker-game"><div id="clicker-score" style="font-size: 4rem; margin-bottom: 20px;">0</div><button id="click-button">–ö–ª–∏–∫–∞–π!</button><button class="btn" id="upgrade-button" style="margin-top: 20px; background-color: #1abc9c; border-color: #1abc9c; color: white;">–ö—É–ø–∏—Ç—å –∞–≤—Ç–æ-–∫–ª–∏–∫ (10)</button><div id="autoclick-info" style="margin-top: 10px;">–ê–≤—Ç–æ-–∫–ª–∏–∫–æ–≤ –≤ —Å–µ–∫: 0</div></div>`;
                const scoreEl = $('#clicker-score'), upgradeBtn = $('#upgrade-button'), autoClickInfo = $('#autoclick-info');
                let score = 0, upgradeCost = 10, autoClicksPerSecond = 0;
                const updateUI = () => { scoreEl.textContent = score; upgradeBtn.textContent = `–ö—É–ø–∏—Ç—å –∞–≤—Ç–æ-–∫–ª–∏–∫ (${upgradeCost})`; autoClickInfo.textContent = `–ê–≤—Ç–æ-–∫–ª–∏–∫–æ–≤ –≤ —Å–µ–∫: ${autoClicksPerSecond}`; };
                $('#click-button').addEventListener('click', () => { score++; AuthManager.updateUserStat('clicker', { highScore: score }); updateUI(); });
                upgradeBtn.addEventListener('click', () => { if (score >= upgradeCost) { score -= upgradeCost; autoClicksPerSecond++; upgradeCost = Math.ceil(upgradeCost * 1.5); updateUI(); } });
                activeGame.interval = setInterval(() => { if (autoClicksPerSecond > 0) { score += autoClicksPerSecond; AuthManager.updateUserStat('clicker', { highScore: score }); updateUI(); } }, 1000);
                updateUI();
            },

            // --- 4. –ù–∞–π–¥–∏ –ü–∞—Ä—É ---
            initMemory(size) {
                $('#game-content-wrapper').innerHTML = `<div id="memory-game-container"><div id="memory-grid"></div><div id="memory-stats"><div>–í—Ä–µ–º—è<span id="memory-timer">0</span></div><div>–•–æ–¥—ã<span id="memory-moves">0</span></div><button class="btn" id="memory-restart">–ó–∞–Ω–æ–≤–æ</button></div></div>`;
                const grid = $('#memory-grid'), timerEl = $('#memory-timer'), movesEl = $('#memory-moves');
                const emojis = ['üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ä', 'üêª', 'üêº', 'üê®', 'üêØ'];
                let cards, hasFlippedCard, lockBoard, firstCard, secondCard, moves, matchedPairs, totalPairs;
                
                const startGame = () => {
                    this.cleanupMemory();
                    moves = 0; matchedPairs = 0; totalPairs = size / 2;
                    movesEl.textContent = moves;
                    timerEl.textContent = 0;
                    grid.style.gridTemplateColumns = `repeat(${size === 20 ? 5 : 4}, 100px)`;

                    let cardEmojis = emojis.slice(0, totalPairs).concat(emojis.slice(0, totalPairs));
                    cardEmojis.sort(() => 0.5 - Math.random());
                    grid.innerHTML = '';
                    cardEmojis.forEach(emoji => {
                        const card = document.createElement('div');
                        card.classList.add('memory-card');
                        card.innerHTML = `<div class="front-face">${emoji}</div><div class="back-face">?</div>`;
                        card.addEventListener('click', flipCard);
                        grid.appendChild(card);
                    });
                    cards = $$('.memory-card');
                };

                const flipCard = (e) => {
                    const clickedCard = e.currentTarget;
                    if (lockBoard || clickedCard === firstCard || clickedCard.classList.contains('flip')) return;
                    if (!activeGame.timer) { activeGame.timer = setInterval(() => timerEl.textContent++, 1000); }
                    clickedCard.classList.add('flip');
                    if (!hasFlippedCard) { hasFlippedCard = true; firstCard = clickedCard; return; }
                    secondCard = clickedCard;
                    moves++; movesEl.textContent = moves;
                    checkForMatch();
                };
                
                const checkForMatch = () => { firstCard.querySelector('.front-face').textContent === secondCard.querySelector('.front-face').textContent ? disableCards() : unflipCards(); };
                const disableCards = () => { firstCard.removeEventListener('click', flipCard); secondCard.removeEventListener('click', flipCard); matchedPairs++; resetBoard(); if (matchedPairs === totalPairs) winGame(); };
                const unflipCards = () => { lockBoard = true; setTimeout(() => { firstCard.classList.remove('flip'); secondCard.classList.remove('flip'); resetBoard(); }, 1200); };
                const resetBoard = () => { [hasFlippedCard, lockBoard] = [false, false]; [firstCard, secondCard] = [null, null]; };
                const winGame = () => { clearInterval(activeGame.timer); activeGame.timer = null; AuthManager.updateUserStat('memory', { bestTime: parseInt(timerEl.textContent), bestMoves: moves }); showToast(`–ü–æ–±–µ–¥–∞! –í—Ä–µ–º—è: ${timerEl.textContent}—Å, –•–æ–¥—ã: ${moves}`, 'success'); };
                this.cleanupMemory = () => { if(activeGame.timer) clearInterval(activeGame.timer); activeGame.timer = null; };
                $('#memory-restart').addEventListener('click', startGame);
                startGame();
            },
            
            // --- 5. –¢–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø–µ—á–∞—Ç–∏ ---
            initTyping() {
                const textSamples = ["–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ –±—ã—Å—Ç—Ä–æ –º–µ–Ω—è—é—Ç –Ω–∞—à –º–∏—Ä, –æ—Ç–∫—Ä—ã–≤–∞—è –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –æ–±—â–µ–Ω–∏—è, —Ä–∞–±–æ—Ç—ã –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏–π. –ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç, –±–ª–æ–∫—á–µ–π–Ω –∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –≤–µ—â–µ–π —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —á–∞—Å—Ç—å—é –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π –∂–∏–∑–Ω–∏.", "–ö–æ—Å–º–æ—Å –≤—Å–µ–≥–¥–∞ –º–∞–Ω–∏–ª —á–µ–ª–æ–≤–µ—á–µ—Å—Ç–≤–æ —Å–≤–æ–∏–º–∏ –∑–∞–≥–∞–¥–∫–∞–º–∏. –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–ª–∞–Ω–µ—Ç, –∑–≤–µ–∑–¥ –∏ –≥–∞–ª–∞–∫—Ç–∏–∫ –ø–æ–º–æ–≥–∞–µ—Ç –Ω–∞–º –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å –∑–∞–∫–æ–Ω—ã –í—Å–µ–ª–µ–Ω–Ω–æ–π –∏ –Ω–∞—à–µ –º–µ—Å—Ç–æ –≤ –Ω–µ–π.", "–ó–¥–æ—Ä–æ–≤—ã–π –æ–±—Ä–∞–∑ –∂–∏–∑–Ω–∏, –≤–∫–ª—é—á–∞—é—â–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è, —è–≤–ª—è–µ—Ç—Å—è –∫–ª—é—á–æ–º –∫ –¥–æ–ª–≥–æ–ª–µ—Ç–∏—é –∏ —Ö–æ—Ä–æ—à–µ–º—É —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏—é. –í–∞–∂–Ω–æ –∑–∞–±–æ—Ç–∏—Ç—å—Å—è –æ —Å–µ–±–µ."];
                const textToType = textSamples[Math.floor(Math.random() * textSamples.length)];
                $('#game-content-wrapper').innerHTML = `<div id="typing-test-container"><div id="typing-text"></div><div id="typing-stats" style="margin-top: 20px;"><div><h3>WPM</h3><span id="typing-wpm">0</span></div><div><h3>–¢–æ—á–Ω–æ—Å—Ç—å</h3><span id="typing-accuracy">100%</span></div><div><h3>–í—Ä–µ–º—è</h3><span id="typing-timer">0</span></div></div><button class="btn" id="typing-restart" style="margin-top: 20px;">–ó–∞–Ω–æ–≤–æ</button></div>`;
                const textEl = $('#typing-text'), wpmEl = $('#typing-wpm'), accEl = $('#typing-accuracy'), timerEl = $('#typing-timer');
                let charIndex = 0, mistakes = 0;
                
                const startGame = () => {
                    charIndex = 0; mistakes = 0;
                    if(activeGame.timer) clearInterval(activeGame.timer); activeGame.timer = null;
                    if(activeGame.keyListener) document.removeEventListener('keydown', activeGame.keyListener);
                    
                    textEl.innerHTML = textToType.split('').map(char => `<span>${char}</span>`).join('');
                    textEl.querySelector('span').classList.add('caret');
                    wpmEl.textContent = '0'; accEl.textContent = '100%'; timerEl.textContent = '0';
                    
                    activeGame.keyListener = handleKeyPress;
                    document.addEventListener('keydown', activeGame.keyListener);
                };
                
                const handleKeyPress = (e) => {
                    e.preventDefault();
                    if (e.key.length !== 1 || charIndex >= textToType.length) return;
                    if (!activeGame.timer) { activeGame.timer = setInterval(() => timerEl.textContent++, 1000); }
                    
                    const currentSpan = $$('#typing-text span')[charIndex];
                    currentSpan.classList.remove('caret');

                    if (e.key === currentSpan.textContent) {
                        currentSpan.classList.add('correct');
                    } else {
                        currentSpan.classList.add('incorrect');
                        mistakes++;
                    }
                    charIndex++;
                    
                    const accuracy = Math.round(((charIndex - mistakes) / charIndex) * 100) || 100;
                    accEl.textContent = `${accuracy}%`;
                    const wpm = Math.round(((charIndex - mistakes) / 5) / (parseInt(timerEl.textContent) / 60)) || 0;
                    wpmEl.textContent = wpm > 0 ? wpm : 0;

                    if (charIndex === textToType.length) {
                        clearInterval(activeGame.timer);
                        document.removeEventListener('keydown', activeGame.keyListener);
                        AuthManager.updateUserStat('typing', { bestWPM: wpm, bestAccuracy: accuracy });
                        showToast(`–ì–æ—Ç–æ–≤–æ! WPM: ${wpm}, –¢–æ—á–Ω–æ—Å—Ç—å: ${accuracy}%`, 'success');
                    } else {
                        $$('#typing-text span')[charIndex].classList.add('caret');
                    }
                };

                $('#typing-restart').addEventListener('click', startGame);
                startGame();
            }
        };

        // =======================================================
        // --- –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –í–°–ï–ì–û –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ---
        // =======================================================
        AuthManager.init();
        UI.init();
        Leaderboard.updateAll();
        GameManager.init();
    });
    </script>
</body>
</html>

            
