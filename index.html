<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Средневековая RPG мини-игра</title>
<style>
body {
  margin: 0;
  font-family: 'Arial', sans-serif;
  background-color: #222;
  color: #ccc;
}
/* Заголовок */
header {
  display: flex;
  align-items: center;
  padding: 10px;
  background-color: #333;
}
#avatar {
  width: 60px;
  height: 60px;
  border-radius: 50%;
  margin-right: 15px;
}
#nickname {
  font-size: 1.5em;
  font-weight: bold;
  color: #f55;
}
/* Основной контейнер */
.container {
  display: flex;
  flex-wrap: wrap;
  padding: 10px;
}
.menu {
  width: 100%;
  display: flex;
  justify-content: center;
  margin-bottom: 15px;
}
.menu button {
  background-color: #c00;
  color: #fff;
  border: none;
  padding: 12px 20px;
  margin: 0 10px;
  border-radius: 5px;
  font-weight: bold;
  cursor: pointer;
}
.menu button:hover {
  background-color: #a00;
}
/* Вкладки */
.tabs {
  display: none;
  width: 100%;
}
.active {
  display: block;
}
/* Общие стили для панелей */
.panel {
  background-color: #444;
  border-radius: 10px;
  padding: 15px;
  margin: 10px 0;
}
h2 {
  color: #f55;
  margin-top: 0;
}
button {
  background-color: #c00;
  border: none;
  padding: 10px 15px;
  border-radius: 5px;
  color: #fff;
  font-weight: bold;
  cursor: pointer;
}
button:hover {
  background-color: #a00;
}
/* Прогресс бар */
.progress {
  background-color: #555;
  border-radius: 10px;
  overflow: hidden;
  height: 20px;
  margin-top: 10px;
  width: 100%;
}
.progress-bar {
  height: 100%;
  background-color: #f55;
  width: 0%;
  transition: width 0.3s;
}
/* Списки */
ul {
  list-style: none;
  padding: 0;
}
li {
  padding: 5px 0;
}
#achievementList, #playersRanking {
  max-height: 200px;
  overflow-y: auto;
}
/* Адаптивность */
@media(max-width: 900px) {
  .container {
    flex-direction: column;
  }
}
</style>
</head>
<body>

<header>
  <img id="avatar" src="https://via.placeholder.com/60" alt="Аватар" />
  <div id="nickname">Никнейм</div>
  <div style="margin-left:auto; padding-right:10px;">Lvl: <span id="levelSpan">1</span></div>
</header>

<div class="menu">
  <button data-tab="profile">Профиль</button>
  <button data-tab="work">Работы</button>
  <button data-tab="inventory">Инвентарь</button>
  <button data-tab="market">Рынок</button>
  <button data-tab="bank">Банк</button>
  <button data-tab="quests">Квесты</button>
  <button data-tab="achievements">Достижения</button>
  <button data-tab="rating">Рейтинг</button>
</div>

<div id="tabs">
  <!-- Профиль -->
  <div class="tabs active" id="profile">
    <div class="panel">
      <h2>Профиль</h2>
      <p>Уровень: <span id="playerLevel">1</span></p>
      <p>Опыт: <span id="playerXP">0</span> / <span id="xpNeeded">10</span></p>
      <div class="progress" style="width:100%">
        <div class="progress-bar" id="xpProgress"></div>
      </div>
      <p>Золото: <span id="playerGold">0</span></p>
      <p>Текущий опыт: <span id="currentXP">0</span></p>
      <button id="clickerBtn">Заработать опыт</button>
    </div>
  </div>

  <!-- Работа -->
  <div class="tabs" id="work">
    <div class="panel">
      <h2>Работы</h2>
      <p>Заработок за работу: <span id="workEarnings">+0</span> золота</p>
      <button id="workBtn">Работать</button>
      <h3>История работы</h3>
      <ul id="workHistory"></ul>
    </div>
  </div>

  <!-- Инвентарь -->
  <div class="tabs" id="inventory">
    <div class="panel">
      <h2>Инвентарь</h2>
      <ul id="inventoryItems"></ul>
      <button id="buyItem">Купить предмет</button>
    </div>
  </div>

  <!-- Рынок -->
  <div class="tabs" id="market">
    <div class="panel">
      <h2>Рынок</h2>
      <ul id="marketItems"></ul>
    </div>
  </div>

  <!-- Банк -->
  <div class="tabs" id="bank">
    <div class="panel">
      <h2>Банк</h2>
      <p>Баланс банка: <span id="bankBalance">0</span></p>
      <button id="depositBtn">Вложить</button>
      <button id="withdrawBtn">Снять</button>
    </div>
  </div>

  <!-- Ежедневные квесты -->
  <div class="tabs" id="quests">
    <div class="panel">
      <h2>Ежедневные квесты</h2>
      <p>Выполнено квестов: <span id="questsCount">0</span></p>
      <button id="dailyQuestBtn">Выполнить квест</button>
    </div>
  </div>

  <!-- Достижения -->
  <div class="tabs" id="achievements">
    <div class="panel">
      <h2>Достижения</h2>
      <ul id="achievementList"></ul>
    </div>
  </div>

  <!-- Рейтинг -->
  <div class="tabs" id="rating">
    <div class="panel">
      <h2>Рейтинг игроков</h2>
      <ol id="playersRanking"></ol>
    </div>
  </div>
</div>

<script>
  // Объект пользователя
  const userData = {
    nickname: "Игрок",
    avatar: "https://via.placeholder.com/60",
    level: 1,
    experience: 0,
    gold: 0,
    inventory: [],
    bank: 0,
    questsCompleted: 0,
    achievements: [],
    rating: []
  };

  // Хранилище данных
  function saveData() {
    localStorage.setItem('medieval_rpg_save', JSON.stringify(userData));
  }
  function loadData() {
    const data = localStorage.getItem('medieval_rpg_save');
    if (data) {
      Object.assign(userData, JSON.parse(data));
    }
  }

  // Обновление интерфейса
  function updateUI() {
    document.getElementById('nickname').innerText = userData.nickname;
    document.getElementById('avatar').src = userData.avatar;
    document.getElementById('playerLevel').innerText = userData.level;
    document.getElementById('playerXP').innerText = userData.experience;
    document.getElementById('xpNeeded').innerText = userData.level * 10;
    document.getElementById('playerGold').innerText = userData.gold;
    document.getElementById('bankBalance').innerText = userData.bank;
    document.getElementById('questsCount').innerText = userData.questsCompleted;
    // прогресс XP
    const xpPercent = (userData.experience / (userData.level * 10)) * 100;
    document.getElementById('xpProgress').style.width = Math.min(xpPercent, 100) + '%';

    // Инвентарь
    const invList = document.getElementById('inventoryItems');
    invList.innerHTML = '';
    userData.inventory.forEach(item => {
      const li = document.createElement('li');
      li.innerText = item.name + ' x' + item.count;
      invList.appendChild(li);
    });

    // Достижения
    const achList = document.getElementById('achievementList');
    achList.innerHTML = '';
    userData.achievements.forEach(a => {
      const li = document.createElement('li');
      li.innerText = a;
      achList.appendChild(li);
    });

    // Рейтинг (заглушка)
    const ratingList = document.getElementById('playersRanking');
    ratingList.innerHTML = '';
    userData.rating.forEach((player, index) => {
      const li = document.createElement('li');
      li.innerText = `{player.name} — ${player.level} уровень`;
      ratingList.appendChild(li);
    });
  }

  // Инициализация
  loadData();
  updateUI();

  // Логика кнопок
  document.querySelectorAll('.menu button').forEach(btn => {
    btn.onclick = () => {
      document.querySelectorAll('.tabs').forEach(tab => tab.classList.remove('active'));
      document.getElementById(btn.dataset.tab).classList.add('active');
    };
  });

  // Зарабатывать опыт
  document.getElementById('clickerBtn').onclick = () => {
    userData.experience += 1;
    if (userData.experience >= userData.level * 10) {
      userData.level++;
      userData.experience = 0;
      userData.achievements.push(`Достигнут уровень ${userData.level}`);
    }
    saveData();
    updateUI();
  };

  // Работа
  document.getElementById('workBtn').onclick = () => {
    const earnings = Math.floor(Math.random() * 10) + 5;
    userData.gold += earnings;
    userData.achievements.push(`Заработано за работу: ${earnings} золота`);
    document.getElementById('workEarnings').innerText = '+' + earnings;
    // история
    const history = document.getElementById('workHistory');
    const li = document.createElement('li');
    li.innerText = `Заработано: ${earnings} золота за работу.`;
    history.appendChild(li);
    saveData();
    updateUI();
  };

  // Инвентарь
  document.getElementById('buyItem').onclick = () => {
    const item = {name: 'Меч', count: 1};
    const existing = userData.inventory.find(i => i.name === item.name);
    if (existing) {
      existing.count++;
    } else {
      userData.inventory.push(item);
    }
    userData.gold -= 10; // Цена
    if (userData.gold < 0) userData.gold = 0;
    saveData();
    updateUI();
  };

  // Ежедневный квест
  document.getElementById('dailyQuestBtn').onclick = () => {
    userData.questsCompleted++;
    userData.gold += 20;
    userData.achievements.push('Выполнен ежедневный квест');
    // Добавление в рейтинг
    userData.rating.push({name: userData.nickname, level: userData.level});
    saveData();
    updateUI();
  };

  // Вложить в банк
  document.getElementById('depositBtn').onclick = () => {
    if (userData.gold > 0) {
      userData.bank += userData.gold;
      userData.gold = 0;
    }
    saveData();
    updateUI();
  };
  // Снять со счета
  document.getElementById('withdrawBtn').onclick = () => {
    if (userData.bank > 0) {
      userData.gold += userData.bank;
      userData.bank = 0;
    }
    saveData();
    updateUI();
  };

  // Обновление рейтинга (по уровню)
  function updateRating() {
    userData.rating.sort((a, b) => b.level - a.level);
  }

  // Инициализация и обновление
  setInterval(() => {
    // Постоянное увеличение опыта для симуляции
    userData.experience += 0.1;
    if (userData.experience >= userData.level * 10) {
      userData.level++;
      userData.experience = 0;
      userData.achievements.push(`Автоматический уровень ${userData.level} достигнут`);
    }
    saveData();
    updateUI();
  }, 60000); // каждую минуту

  // Сохраняем прогресс при закрытии
  window.onbeforeunload = () => {
    saveData();
  };
</script>
</body>
</html>
